008 DO NOT DELETE THIS LINE

                             FOR MODEL DEFINITIONS AND REFERENCES REFER TO THE GLOSSARY AT:

                             www.perplex.ethz.ch/perplex_documentation.html#SOLUTION_MODEL_GLOSSARY

                             DO NOT USE TABS IN PERPLE_X DATA FILES, TAB CHARACTERS ARE NOT INTERPRETED AS BLANK SPACES 
                             AND CAUSE FORMATTING ERRORS.

                             Solution model type flags are:

                             0  - internal (fluid) EoS
                             1  - simple microscopic formulation (described in terms of bragg-williams fractions)
                             2  - simple macroscopic formulation (described in terms of endmember fractions)
                             6  - macroscopic formulation with speciation.
                             7  - macroscopic formulation reciprocal solution with dependent endmembers.
                             8  - macroscopic formulation reciprocal solution with dependent endmembers and speciation.

                             Special models:

                             23 - Toops-Samis melt model
                             24 - Holland & Powell Haplogranite melt model 
                             25 - Ghirso pMELTS/MELTS model
                             26 - Haefner H2O-CO2-NaCl

                             For non-ideal solutions, microscopic models assume Margules type excess functions; 
                             macroscopic models may be posed in terms of Margules (See model "Bio(HP)" for a commented
                             example) or Van Laar (e.g., Holland and Powell, CMP 2003; See model Fsp(C1) for a commented 
                             example) excess functions. The format of model type 1 is described in detail in the Perple_X 
                             program documentation (vdoc.pdf).
                           
                             The format for all other model types is not yet documented, but may be deduced from the commentary
                             within the models included herein. Character data is format free in all models except model type 1.

                             comments can be placed between models provided, nothing is written in the first 10 columns. Comments 
                             may be placed after data if it is separated from the data by a '|' marker.

                             Detailed commentary is provided for the Bio(HP) model below:  

                      --------------------------------------------------------
begin_model                         
                             
                             Ti-Fe3+ Biotite from Tajcmanova et al., JMG 2009;
                             extended for Mn solution after Tinkham et al. 2001.

                             Model entered by Lucie Tajcmanova, December, 2008.

                             NOTE this model requires the following make definitions 
                             in the thermodynamic data file:

                             tbit = 1 phl - 1 br + 1 ru           84e3 -11.5 0 
                             fbit = 1 east - 1/2 cor + 1/2 hem    6e3 0 0  


                                      Site:           M1      M2       T1     H
                                                     ____________________________

                                      Mutliplicity    1       2        2      2       

                                    endmember        ____________________________   type
                                    _________                                       _________

                                        mfbit         Fe3+   MnMn     AlAl    OH    dependent
                                        ffbit         Fe3+   FeFe     AlAl    OH    dependent 
                                        fbit          Fe3+   MgMg     AlAl    OH
                          
                                        mtbit         Mn     TiMn     AlSi    O     dependent
                                        ftbit         Fe     TiFe     AlSi    O     dependent
                                        tbit          Mg     TiMg     AlSi    O
   
                                        mts           Al     MnMn     AlAl    OH    dependent  
                                        sdph          Al     FeFe     AlAl    OH    dependent
                                        east          Al     MgMg     AlAl    OH

                                        mnbi          Mn     MnMn     AlSi    OH
                                        ann           Fe     FeFe     AlSi    OH
                                        phl           Mg     MgMg     AlSi    OH

                                        obi           Fe     MgMg     AlSi    OH    ordered

                       

Bio(TCC)                     | model name

8                            | model type: reciprocal, margules with dependent endmembers, one ordering parameter

2                            | 2 independent mixing sites, reciprocal solution 

3  4                         | 3 components {Mn, Fe2+, Mg} for composition 1, 4 components {Al, Si, Fe3+, Ti} for composition 2. 
                             
mfbit     ffbit     fbit     | endmember names 
mtbit     ftbit     tbit
mts       sdph      east        
mnbi      ann       phl               
        
1                            | 1 ordered species:

obi = 2/3 phl + 1/3 ann   enthalpy_of_formation = -6.8d3  

6                            | 6 dependent endmembers 
                            
sdph    = 1 east + 1 ann    - 1 obi  
mts     = 1 east + 2/3 mnbi - 2/3 phl 
mfbit   = 1 fbit + 2/3 mnbi - 2/3 phl   
mtbit   = 1 tbit + 2/3 mnbi - 2/3 phl    
ffbit   = 1 fbit + 1 ann    - 1 obi 
ftbit   = 1 tbit + 1/2 ann  + 1/2 obi - 1 phl      
 
0 0 0 0 0 0 0 0 0 0 0 0      | endmember flags
                   
0. .2 .1  1                  | range and resolution of X(Mn, M2), mod = 1 -> assymetric subdivision                             
0. 1. .1  0                  | range and resolution of X(Mg, M2), mod = 0 -> cartesian subdivision  

0. 1. .1  1                  | range and resolution of X(Fe3+,*), mod = 1 -> assymetric subdivision    
0. 1. .1  1                  | range and resolution of X(Ti,  *), mod = 1 -> assymetric subdivision  
0. 1. .1  0                  | range and resolution of X(Al,  *), mod = 0 -> cartesian subdivision           

begin_excess_function
W(phl ann)   12000. 0. 0.    | excess parameters from Holland & Powell, JMG, 2006
W(phl east)  10000. 0. 0.  
W(phl obi)    4000. 0. 0. 
W(ann east)   3000. 0. 0.  
W(ann obi)    8000. 0. 0.
W(obi east)   7000. 0. 0. 
end_excess_function 

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

5 1.                        | 5 species on M1, 1 site per formula unit.

z(m1,fe)   = 1 ann + 1 obi 
z(m1,mg)   = 1 phl + 1 tbit     
z(m1,mn)   = 1 mnbi 
z(m1,Fe3+) = 1 fbit

4 2.                        | 4 species on M2, 2 sites per formula unit.

z(m2,fe)   = 1 ann                                  
z(m2,Ti)   = 1/2 tbit                                                                                  
z(m2,mn)   = 1 mnbi 
    
2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,al)   = 1/2 + 1/2 east + 1/2 fbit 

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o)     = 1 tbit

end_of_model    
                      --------------------------------------------------------
begin_model 
                      ORTHOAMPHIBOLE: Diener et al, JMG 2007 25:631-656

                      NOTE to use this the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                              mpa      = 1 parg - 1 tr +1 anth dqf(27d3)
                              ged_dqf  = dqf(ged)   22000. 0. 0.
                              ogl_dqf  = dqf(gl)    15000. 0. 0. 
                              fanth_dq = dqf(fanth)  7000. 0. 0.
                              omrb_dqf = 1 gl -2 jd -2 acm dqf(33d3)

                       additionally the following endmembers should be excluded in the 
                       computational option file:

                              ged 
                              fanth 
                              gl 

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si      independent
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si      dependent
                             3 ged_dqf       Vac       Mg      Al     Mg      Al_Si      independent
                             4 fged          Vac       Fe      Al     Fe      Al_Si      dependent
                             5 mpa           Na        Mg      Mg_Al  Mg      Al_Si      independent
                             6 fpa           Na        Fe      Fe_Al  Fe      Al_Si      dependent
                             7 ogl_dqf       Vac       Mg      Al     Na      Si_Si      independent
                             8 fgl           Vac       Fe      Al     Na      Si_Si      dependent
                             9 anth          Vac       Mg      Mg     Mg      Si_Si      independent
                            10 fanth_dq      Vac       Fe      Fe     Fe      Si_Si      independent
                            11 omrb_dqf      Vac       Mg      Fe3+   Na      Si_Si      independent
                            12 frb           Vac       Fe      Fe3+   Na      Si_Si      dependent

                            13 ammo1         Vac       Mg      Fe     Fe      Si_Si      ordered
                            14 ammo2         Vac       Fe      Mg     Fe      Si_Si      ordered 

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        however in Diener et al '07 the multiplicity has been reduced to 1.  

                        JADC 9/07. 

                        10/07   z(m2a,al) corrected.  
                                          Y. Podladchikov.
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected, 
                                T1 multiplicity reduced to 1. 
                                Enthalpies of ordering corrected.
                                          JADC.
                         8/08   Enthalpy of ordering corrected for HP dqfs.
     
oAmph(DP)                    | model name 
8                            | model type: reciprocal, margules, two ordering parameters
2                            | 2 site reciprocal solution
2 6                          | 1 binary and 1 hexary                
tr            ftr      
mpa           fpa  
ged_dqf       fged  
ogl_dqf       fgl 
anth          fanth_dq 
omrb_dqf      frb 


2                            | 2 ordered species:

ammo1 = 3/7 anth + 4/7 fanth_dq  enthalpy_of_formation = -9.5d3
ammo2 = 2/7 anth + 5/7 fanth_dq   enthalpy_of_formation = -11.7d3

begin_limits
ammo1 = -7/4 + 7/4 fanth_dq + 1 ammo1 + 1/2 ammo2 + 5/4 ammo2                               delta = 7/4
ammo1 = -7/3 + 7/3 tr + 7/6 mpa + 7/3 anth + 1 ammo1 + 5/3 ammo2 + 2/3 ammo2                delta = 7/3
ammo1 = -7/3 + 7/3 mpa + 7/3 anth + 7/3 ged_dqf + 1 ammo1  - 2/3 ammo2 + 2/3 ammo2          delta = 7/3
ammo1 =      - 7/3 fanth_dq - 4/3 ammo1 - 2/3 ammo2 - 5/3 ammo2                             delta = 7/3
ammo1 =      - 7/3 fanth_dq - 4/3 ammo1 + 5/3 ammo2 - 5/3 ammo2                             delta = 7/3

ammo2 = -7/2 fanth_dq + 2 ammo1 - 2 ammo1 - 5/2 ammo2                                       delta = 7/2
ammo2 = -7/5 tr - 7/10 mpa - 7/5 anth + 3/5 ammo1 - 3/5 ammo1 - 2/5 ammo2                   delta = 7/5
ammo2 = -7/2 + 7/2 anth + 7/2 mpa + 7/2 ged_dqf - 3/2 ammo1 + 3/2 ammo1 + 1 ammo2           delta = 7/2
ammo2 =      - 7/2 fanth_dq - 3/2 ammo1 - 2 ammo1 - 5/2 ammo2                               delta = 7/2
ammo2 = -7/5 + 7/5 fanth_dq + 3/5 ammo1 + 4/5 ammo1 + 1 ammo2                               delta = 7/5
end_limits

5                            | 5 dependent endmembers 

ftr   = 1 tr + 2 fanth_dq - 1 ammo1 - 1 ammo2
fpa   = 1 mpa + 1/2 fanth_dq + 1/2 ammo2 - 1 anth
fged  = 1 ged_dqf - 1 anth + 1 ammo2
fgl   = 1 ogl_dqf +  1 fanth_dq - 1 ammo1
frb   = 1 omrb_dqf + 1 fanth_dq - 1 ammo1


0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  1 1 1 1 1 1 1 1 1 1 1 1    | endmember flags.

0. 1.0 0.1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.  .1  0               | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(pa) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  .1  0               | range and resolution for X(ged_dqf) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(ogl_dqf) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(anth) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(anth ged_dqf)       25d3  0  0
W(anth mpa)           25d3  0  0
W(anth ogl_dqf)       65d3  0  0
W(anth tr)            45d3  0  0
W(anth fanth_dq)      33d3  0  0
W(anth omrb_dqf)      65d3  0  0 
W(anth ammo1)         18d3  0  0
W(anth ammo2)         23d3  0  0

W(ged_dqf mpa)           -40d3  0  0
W(ged_dqf ogl_dqf)        25d3  0  0
W(ged_dqf tr)             70d3  0  0
W(ged_dqf fanth_dq)     39.5d3  0  0
W(ged_dqf omrb_dqf)       25d3  0  0 
W(ged_dqf ammo1)          29d3  0  0
W(ged_dqf ammo2)        34.6d3  0  0

W(mpa ogl_dqf)       50d3  0  0
W(mpa tr)            90d3  0  0
W(mpa fanth_dq)      45d3  0  0
W(mpa omrb_dqf)      50d3  0  0 
W(mpa ammo1)       33.2d3  0  0
W(mpa ammo2)         36d3  0  0

W(ogl_dqf tr)            65d3  0  0
W(ogl_dqf fanth_dq)    81.2d3  0  0
W(ogl_dqf ammo1)       65.5d3  0  0
W(ogl_dqf ammo2)       78.4d3  0  0

W(tr fanth_dq)        75d3 0  0
W(tr omrb_dqf)       65d3  0  0 
W(tr ammo1)          57d3  0  0
W(tr ammo2)          63d3  0  0

W(fanth_dq omrb_dqf)   81.2d3  0  0 
W(fanth_dq ammo1)        12d3  0  0
W(fanth_dq ammo2)         8d3  0  0

W(omrb_dqf ammo1)       65.5d3  0  0 
W(omrb_dqf ammo2)       78.4d3  0  0 

W(ammo1 ammo2)            20d3  0  0
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na)    = 1 mpa 
              
2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al)   = 1/2 ged_dqf + 1/2 mpa 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,fe)   = 1 fanth_dq + 1 ammo2

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,fe)   = 1 fanth_dq + 1 ammo1
z(m2,al)   = 1 ged_dqf + 1/2 mpa  + 1 ogl_dqf  
z(m2,fe3+) = 1 omrb_dqf 

4 2.                       | 4 species on M4, 2 sites pfu
z(m4,ca)   = 1 tr      
z(m4,mg)   = 1 mpa     + 1 anth + 1 ged_dqf
z(m4,na)   = 1 ogl_dqf + 1 omrb_dqf 

begin_van_laar_sizes                        
alpha(tr)          1.0    0.    0.                      
alpha(ged_dqf)     1.5    0.    0.                      
alpha(mpa)         1.7    0.    0.
alpha(ogl_dqf)     0.8    0.    0.
alpha(anth)        1.0    0.    0.
alpha(fanth_dq)    1.0    0.    0.
alpha(ammo1)       1.0    0.    0.
alpha(ammo2)       1.0    0.    0.
alpha(omrb_dqf)    0.8    0.    0.
end_van_laar_sizes

begin_dqf_corrections

              | Perple_X, in contrast to THERMOCALC, automatically considers all endmembers
              | present in the thermodynamic data base. This behavior creates a potential 
              | problem with THERMOCALC models that specify positive DQF corrections because
              | the DQF'd endmember is always less stable than the real endmember. For example
              | here the solution will always be metastable at compositions near to the ts and 
              | parg endmember compositions. To avoid this problem, DQF corrected endmembers
              | (ged_dqf, ogl_dqf, fanth_dq and omrb_dqf) must be specified in the thermodynamic 
              | data file and the true endmembers must be excluded from calculations.  

 | dqf(ged)   22000. 0. 0.
 | dqf(gl)    15000. 0. 0. 
 | dqf(fanth)  7000. 0. 0.
 | dqf(mrb)   25000. 0. 0.

end_dqf_corrections

end_of_model   

                      --------------------------------------------------------
begin_model          
                                      Green, ECR, Holland, TJB & Powell, R (2007) An order-disorder model for
                                      omphacitic pyroxenes in the system jadeite-diopside-hedenbergite-acmite,
                                      with applications to eclogite rocks. American Mineralogist, 92, 1181-1189.

                                      WARNING: The choice of independent ordered species (here, cfm, om, jac)
                                      has the conseqence that this model CANNOT be used for the following
                                      subcompositions:

                                          jd-hed, hed-acm, di-acm, hed-acm-jd, hed-acm-di

                                      to work in these joins either fom, hac, or dac must replace either 
                                      om or/and cfm.
                              
                                                         Site:
                                                       1      2      3      4    
                                                      M2a    M2b    M1a    M1b     
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2   
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg    
                            Species:  2 Jadeite       Na     Na     Al     Al    
                                      3 Hedenbergite  Ca     Ca     Fe2+   Fe2+ 
                                      4 Acmite        Na     Na     Fe3+   Fe3+  
                                                      ___________________________________

                        Ordered Cpd:  5 om            Na     Ca     Al     Mg   
                                      6 cfm           Ca     Ca     Mg     Fe 
                                      7 jac           Na     Na     Fe3+   Al



Omph(GHP)     
6                           | model type margules with multiple compound formation  
                                                                       
4                           | disordered endmembers

di       
jd   
acm   
hed

3                            | number of ordered species 

om   = 1/2 jd + 1/2 di   enthalpy_of_formation  =  -2.9d3 
cfm  = 1/2 di + 1/2 hed  enthalpy_of_formation  =  -1.5d3
jac  = 1/2 jd + 1/2 acm  enthalpy_of_formation  =  -1d3  
                             | fom  = 1/2 jd + 1/2 hed  enthalpy_of_formation  =  -3.6d3
begin_limits
om = -2 + 2 di + 2 hed   delta = 2
om = -2 + 2 jd + 2 acm   delta = 2 
om = -2 + 2 di + 1 cfm   delta = 2 
om = -2 + 2 jd + 1 jac   delta = 2 
om = -2 + 2 acm + 2 jd + 2 hed + 1 cfm delta = 2
om = -2 + 2 acm + 2 di + 2 hed + 1 jac delta = 2


cfm = -2 di + 1 om       delta = 2
cfm = -2 + 2 hed         delta = 2
cfm = -2 hed             delta = 2
cfm = -2 jd - 2 hed - 2 acm + 1 om      delta = 2

jac = -2 acm             delta = 2
jac = -2 jd + 1 om       delta = 2
jac = -2 + 2 acm         delta = 2
jac = -2 acm - 2 di - 2 hed + 1 om      delta = 2
end_limits
 

0  0  0  0                   | endmember flags

0. 1. 0.1  0                 | range and resolution of X(di)
0. 1. 0.1  0                 | range and resolution of X(jd)
0. 1. 0.1  0                 | range and resolution of X(acm) 

begin_excess_function   
W(jd di)       26d3  0  0 1
W(jd hed)      24d3  0  0 2
W(jd acm)       5d3  0  0
W(jd om)     15.5d3  0  0 3
W(jd cfm)    25.2d3  0  0 4      
W(jd jac)       3d3  0  0
W(di hed)       4d3  0  0 5
W(di acm)      15d3  0  0
W(di om)    15.75d3  0  0 6
W(di cfm)       2d3  0  0 7
W(di jac)   21.05d3  0  0
W(hed acm)     14d3  0  0
W(hed om)    17.2d3  0  0  8     
W(hed cfm)      2d3  0  0 9
W(hed jac)   20.1d3  0  0
W(acm om)    12.8d3  0  0
W(acm cfm)   15.5d3  0  0
W(acm jac)      3d3  0  0
W(om cfm)   18.45d3  0  0 10
W(om jac)    19.3d3  0  0
W(cfm jac)  21.05d3  0  0
                             | W(fom cfm)  17.75d3  0  0 11
                             | W(fom di)   17.05d3  0  0 12
                             | W(fom hed)  14.5d3   0  0 13
                             | W(fom jd )  14.d3    0  0 14
                             | W(fom cfm)  15.75d3  0  0 15
                             | W(fom om)       2d3  0  0 16
end_excess_function

4                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

4 0.5                               | 4 species on m1b, mult = 1/2
z(m1b,al)   = 1 jd + 1 jac 
z(m1b,fe2+) = 1 hed + 1 cfm 
z(m1b,fe3+) = 1 acm 

2 0.5                               | 2 species on m2a, mutiplicity = 1/2
z(m2a,ca)   = 1 di + 1 hed + 1 cfm

2 0.5                               | 2 species on m2b, mult. = 1/2
z(m2b,na)   = 1 jd + 1 acm + 1 jac 

4 0.5                               | 4 species on m1a, mult = 1/2
z(m1a,mg)   = 1 di + 1 cfm 
z(m1a,fe2+) = 1 hed 
z(m1a,fe3+) = 1 acm + 1 jac 

end_of_model                     
                    --------------------------------------------------------  
begin_model               
                      CLINOAMPHIBOLE: Diener et al., JMG 2007 25:631-656 

                      NOTE to use this model the following endmembers must be specified with make 
                      definitions in the thermodynamic data file

                          ts_dqf   = dqf(ts)   10000. 0. 0.  
                          parg_dqf = dqf(parg) 10000. 0. 0.
                          gl_dqf   = dqf(gl)    3000. 0. 0.

                       additionally the following endmembers should be excluded in the 
                       computational option file:

                          ts
                          parg
                          gl

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       1(4)*
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si      independent
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si      dependent
                             3 ts_dqf        Vac       Mg      Al     Ca      Al_Si      independent
                             4 fts           Vac       Fe      Al     Ca      Al_Si      dependent
                             5 parg_dqf      Na        Mg      Mg_Al  Ca      Al_Si      independent
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si      dependent
                             7 gl_dqf        Vac       Mg      Al     Na      Si_Si      independent
                             8 fgl           Vac       Fe      Al     Na      Si_Si      dependent
                             9 cumm          Vac       Mg      Mg     Mg      Si_Si      independent
                            10 grun          Vac       Fe      Fe     Fe      Si_Si      independent
                            11 mrb           Vac       Mg      Fe3+   Na      Si_Si      independent
                            12 frb           Vac       Fe      Fe3+   Na      Si_Si      dependent

                            13 cammo1        Vac       Mg      Fe     Fe      Si_Si      ordered
                            14 cammo2        Vac       Fe      Mg     Fe      Si_Si      ordered 

                        *T1 has a true multiplicity of 4, H&P previously used an effective multiplicity of 2;
                        however in Diener et al. '07 the multiplicity has been reduced to 1. 

                        JADC 9/07. 

                        10/07   z(m2a,al) corrected. Y Y. Podladchikov
                         3/08   z(m1a,mg),z(m4,ca),z(m4,mg), and fged corrected, 
                                T1 multiplicity reduced to 1. 
                                Enthalpies of ordering corrected. JADC.
                         6/08   z(m1,mg) corrected to include mrb, second limit
                                equations for cammo1 and cammo2 corrected accordingly.   
                                corrected enthalpies for cammo1 and cammo2.            
     

cAmph(DP)                    | solution name 
8                            | model type: reciprocal, margules, two ordering parameters
2                            | 2 site reciprocal solution
2 6                          | 1 binary and 1 hexary                
tr         ftr      
parg_dqf   fparg  
ts_dqf     fts  
gl_dqf     fgl 
cumm       grun 
mrb        frb 

2                            | 2 ordered species:

cammo1 = 3/7 cumm + 4/7 grun   enthalpy_of_formation = -9.5d3
cammo2 = 2/7 cumm + 5/7 grun   enthalpy_of_formation = -11.7d3

begin_limits

cammo1 = -7/3 grun - 4/3 cammo1 + 5/3 cammo2 - 5/3 cammo2                               delta = 7/3 z(M2,Fe)       
cammo1 = -7/4 + 7/4 grun + 1  cammo1 + 1/2 cammo2 + 5/4 cammo2                          delta = 7/4 z(M1,Fe)
cammo1 = -7/3 + 7/3 tr + 7/6 parg_dqf + 7/3 cumm + 1 cammo1 + 5/3 cammo2 + 2/3 cammo2   delta = 7/3 z(M2,Mg)
cammo1 = -7/3 + 7/3 cumm + 1 cammo1 - 2/3 cammo2 + 2/3 cammo2                           delta = 7/3 z(M4,Mg)
cammo1 = -7/3 grun - 4/3 cammo1 - 2/3 cammo2 - 5/3 cammo2                               delta = 7/3 z(M4,Fe)

cammo2 = -7/5 + 7/5 grun + 3/5 cammo1 + 4/5 cammo1 + 1 cammo2                           delta = 7/5 z(M2,Fe)
cammo2 = -7/2 grun + 2 cammo1 - 2 cammo1 - 5/2 cammo2                                   delta = 7/2 z(M1,Fe)
cammo2 = -7/5 tr - 7/10 parg_dqf - 7/5 cumm + 3/5 cammo1 - 3/5 cammo1 - 2/5 cammo2      delta = 7/5
cammo2 = -7/2 + 7/2 cumm - 3/2 cammo1 + 3/2 cammo1 + 1 cammo2                           delta = 7/2
cammo2 = -7/2 grun - 3/2 cammo1  - 2 cammo1 - 5/2 cammo2                                delta = 7/2
end_limits

5                            | 5 dependent endmembers 

ftr   = 1 tr + 2 grun - 1 cammo1 - 1 cammo2
fparg = 1 parg_dqf + 3/2 grun - 1 cammo1 - 1/2 cammo2
fgl   = 1 gl_dqf +  1 grun - 1 cammo1
frb   = 1 mrb + 1 grun - 1 cammo1
fts   = 1 ts_dqf + 1 grun - 1 cammo1


1 1 1 1 1 1 1 1 1 1 1 1    | endmember flags.

0. 1.0 0.1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.  .1  0               | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  .1  0               | range and resolution for X(ts_dqf) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision
0. 1.  .1  0               | range and resolution for X(cumm) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
w(mrb tr)          65e3   0. 0.  
w(mrb ts_dqf)      25e3   0. 0. 
w(mrb parg_dqf)    50e3   0. 0. 
                                  | w(mrb gl)     is zero
w(mrb cumm)        100e3   0. 0. 
w(mrb grun)      113.5e3   0. 0. 
w(mrb cammo1)      100e3   0. 0.
w(mrb cammo2)    111.2e3   0. 0.
 
w(cammo2 tr)          63e3   0. 0. 
w(cammo2 ts_dqf)    72.5e3   0. 0.    
w(cammo2 parg_dqf)  94.8e3   0. 0. 
w(cammo2 gl_dqf)   111.2e3   0. 0. 
w(cammo2 cumm)        23e3   0. 0. 
w(cammo2 grun)         8e3   0. 0. 
w(cammo2 cammo1)      20e3   0. 0.

w(cammo1 tr)         57e3   0. 0.
w(cammo1 ts_dqf)     70e3   0. 0.
w(cammo1 parg_dqf) 94.8e3   0. 0.
w(cammo1 gl_dqf)    100e3   0. 0.
w(cammo1 cumm)       18e3   0. 0.
w(cammo1 grun)       12e3   0. 0.

w(grun tr)          75e3   0. 0.
w(grun ts_dqf)      80e3   0. 0.
w(grun parg_dqf) 106.7e3   0. 0.
w(grun gl_dqf)   113.5e3   0. 0.
w(grun cumm)        33e3   0. 0.

w(cumm tr)          45e3   0. 0.
w(cumm ts_dqf)      70e3   0. 0.
w(cumm parg_dqf)    90e3   0. 0.
w(cumm gl_dqf)     100e3   0. 0.

w(gl_dqf tr)          65e3   0. 0.
w(gl_dqf ts_dqf)      25e3   0. 0.
w(gl_dqf parg_dqf)    50e3   0. 0.

w(parg_dqf tr)      25e3   0. 0.
w(parg_dqf ts_dqf) -40e3   0. 0.

w(ts_dqf tr)        20e3   0. 0.
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) =    1 parg_dqf  
              
2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) =   1 tr + 1 ts_dqf + 1 parg_dqf + 1 gl_dqf + 1 cammo1 + 1 cumm + 1 mrb

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg) =   1 tr + 1/2 parg_dqf + 1 cumm + 1 cammo2
z(m2,al) =   1 ts_dqf + 1/2 parg_dqf + 1 gl_dqf 
z(m2,fe3+) = 1 mrb 

4 2.                       | 4 species on M4, 2 sites pfu
z(m4,na) =   1 gl_dqf + 1 mrb 
z(m4,mg) =   1 cumm
z(m4,fe) =   1 grun + 1 cammo1 + 1 cammo2  

2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al) =   1/2 ts_dqf  + 1/2 parg_dqf  

begin_van_laar_sizes                        
alpha(tr)       1.0    0.    0.                      
alpha(parg_dqf) 1.7    0.    0.
alpha(ts_dqf)   1.5    0.    0.                      
alpha(gl_dqf)   0.8    0.    0.
alpha(cumm)     1.0    0.    0.
alpha(grun)     1.0    0.    0.
alpha(cammo1)   1.0    0.    0.
alpha(cammo2)   1.0    0.    0.
alpha(mrb)      0.8    0.    0.
end_van_laar_sizes

begin_dqf_corrections
              
              | Perple_X, in contrast to THERMOCALC, automatically considers all endmembers
              | present in the thermodynamic data base. This behavior creates a potential 
              | problem with THERMOCALC models that specify positive DQF corrections because
              | the DQF'd endmember is always less stable than the real endmember. For example
              | here the solution will always be metastable at compositions near to the ts and 
              | parg endmember compositions. To avoid this problem, DQF corrected endmembers
              | (ts_dqf, gl_dqf and parg_dqf) must be specified in the thermodynamic data file and the
              | true ts, gl and parg endmembers must be excluded from calculations.  


              | dqf(ts)   10000. 0. 0.  
              | dqf(parg) 10000. 0. 0.

dqf(cumm) -6400. 0. 0.
dqf(grun) -5000. 0. 0. 
end_dqf_corrections

end_of_model                   
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                             Fe-Mg-Mn-Biotite with compound formation, Powell and Holland '99 
                             Am Min, extended for Mn-solution.

                             NOTES: 

                             * This model will only function for the MnASH and FASH subsystems
                               if MGO is also used as a component.
                                           
                             * This model was tested with the maple script compete_bio.mws


                             JADC 4/03

                             * Stoichiometric definition of the mnts_i endmember corrected, 2/04. JADC


                                                      1       2      3      
                                                      M1      M2     T2
                                                     _________________________

                                      Mutliplicity    1       2      2 
                                                     _________________________

                                      1 MnBi          Mn      Mn     AlSi   
                            Species:  2 Ann           Fe      Fe     AlSi
                                      3 Phl           Mg      Mg     AlSi        
                          Dependent:  4 MnTs          Al      Mn     AlAl      
                          Dependent:  5 Sdph          Al      Fe     AlAl
                                      6 East          Al      Mg     AlAl
                                                      ________________________

                        Ordered Cpd:  7 Obi           Fe      Mg     AlSi


                             | Comments can be placed before character data within a solution 
                             | model as long as they are preceded by the comment marker "|", 
                             | in general comments should not be placed before numerica data, 
                             | but they can be written following numeric data on the same line.

Bio(HP)                      | solution name.

8                            | model type: Margules with dependent endmembers and speciation.

2                            | the number of independent subcompositions, reciprocal solution if > 1.

3  2                         | 3 species on site 1, 2 species on site 2. this line (see also Sect 1.3.1 
                             | and Sect 4 [READ 3] in vdoc.pdf) defines the geometric
                             | shape of the composition space, in this case a right triangular prism.
                             | the following lines list the endmembers that define the 6 vertices of 
                             | this prism. the geometry can be understood by noting that although 
                             | biotite as 3 subcompositions (refer to the occupancy table above), the
                             | site populations on all 3 sites are determined if the population on any
                             | 2 crystallographic sites. the independent "chemical" subcompositions need
                             | not correspond to the actual crystallographic sites, but in this case
                             | M2 and T2 can be identified as sites 1 and 2, respectively. Thus the
                             | species that mix on site 1 are Mg-Fe-Mn, and the species that mix on 
                             | site 2 are AlSi and AlAl. If the endmember with species i on site 1 and
                             | species j on site 2 is written as endmember ij, then the 6 endmembers will
                             | be read in the order: 11, 21, 31, 12, 22, 32
                             | if instead the binary site had been specified as site 1 and the ternary
                             | site as site 2, then the endmembers would be read in the order: 11, 21, 
                             | 12, 22, 13, 23.

mnbi     ann      phl        | endmember names (refer to the above comment, see also Sect 4 [Read 4] in    
mnts_i   sdph_i   east       | vdoc.pdf), by specifying mnbi as the endmember 11 (i.e., the first 
                             | endmember) the model implies that Mn is species 1 on site 1 (M2), and
                             | AlSi is species 1 on site 2 (T2, and, by default, AlAl must be species 2 
                             | on site 2). In this model, there is a remaining degree
                             | of freedom in that the second species on the first site may be chosen as
                             | either Fe or Mg. This degree of freedom is removed by specifying ann as
                             | endmember 21, implying Fe is species 2 on site 1 (M2, and, by default, Mg 
                             | must be species 3 on site 1). [Note that although sdph has Fe on M2 it could
                             | not be specified as the second endmember because it has species 2 (AlAl) on 
                             | site 2.] The order in which the 4 remaining species are entered is determined
                             | by these assignements, thus the third endmember (31) must have Mg on M2 and 
                             | AlSi on T2 (phl), the fourth endmember (12) must have Mn on M2 and AlAl on 
                             | T2 (mnts), etc. Users should be careful to order the endmembers so as to be 
                             | consistent with these considerations, because mistakes may not be detected 
                             | by vertex and can have dire consequences for computed solution properties. 

1                            | 1 ordered species:

                             | model types 6 and 8 require data defining the
                             | properties of an ordered "species". this species
                             | is defined as a stoichiometric combination of
                             | two independent endmembers and the enthalpy of
                             | formation of the ordered species from the
                             | these independent endmbers. the format for this
                             | data is

                             | name = num_1 * name_1 + num_2 * name_2 text = enthalpy

                             | where name is the arbitrary name of the ordered
                             | species, num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember. text is arbitrary and
                             | enthalpy is the enthalpy of formation of the ordered species.

obi = 2/3 phl + 1/3 ann   enthalpy_of_formation = -10.73d3  

2                            | 2 dependent endmembers 

                             | model types 7 and 8 (reciprocal solutions) use
                             | internal endmembers that are defined as a 
                             | stoichiometric combination of the other endmembers.
                             | the names of these endmembers are arbitrary, but 
                             | here dependent endmembers are highlighted by the 
                             | suffix "_i", this also serves to distinguish the
                             | endmembers from real equivalents that may be 
                             | present in the thermodynamic data file.

                             | the format of this data is

                             | name = num_1 * name_1 + num_2 * name_2

                             | where num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember.

mnts_i = 1 east + 2/3 mnbi - 2/3 phl  
sdph_i = 1 east + 1 ann - 1 obi 

1 0 0 1 0 0                  | endmember flags: if 0 the endmember is considered to be part of the solution.
                   
                             | subdivision model for (ternary) site 1 (M2):

0. .2  .1  1                 | range and resolution of X(Mn), 1 => asymmetric subdivision
0. 1.  .1  0                 | range and resolution of X(Fe), imod = 0 -> cartesian subdivision

0. 1.  .1  0                 | range and resolution of {1-X(Ts)}, imod = 0 -> cartesian subdivision                            
                             
                             | the foregoing lines define the pseudocompound compositions generated
                             | on each "chemical" mixing site of the solution (Sect 4 [READ 6] vdoc.pdf).
                             | for each site the compositional "range" of c-1 species (c is the number of 
                             | species on the site as defined in READ 3) is specified as well as a scheme 
                             | for interpreting the range. each range is defined by 3 numbers XMIN, XMAX, 
                             | and XINC, and the scheme is specified by an integer (IMD) written after the 
                             | c-1 ranges. The simplest scheme is cartesian, in which case IMD = 0 and the
                             | the XMIN, XMAX, and XINC indicate the range of compositions (from XMIN to XMAX) 
                             | of the respective c-1 species and the compositional spacing (XINC) of the 
                             | pseudocompounds. As entered above, the subdivision scheme will generate 
                             | pseudocompounds with X(Mn) on site 1 from 0 to 0.20 mol at 0.01 mol increments
                             | for each X(Mn) isopleth, compounds will be generated with X(Fe) from 0 to 1-X(Mn),
                             | where "0" and "1" correspond to XMIN and XMAX in the range for the second species
                             | on site 1, and X(Mg) = 1 - X(Fe) - X(Mn).

                             | Alternative subdivision shemes detailed in vdoc.pdf, may be useful for specialized
                             | applications, e.g., creating models with variable compositional resolution.

                             | By restricting the ranges specified in a model it is possible to focus pseudocompounds
                             | over a particular portion of a solutions composition space, such focusing can be 
                             | computationally advantageous when it is known a priori that only a limited range of
                             | compositions can be stable, but it should be undertaken with caution because the 
                             | results are not always easy to anticipate. 

                             | The primary difficulty in restricting compositional ranges is that the user 
                             | can explicitly control the composition of only c-1 compositions since the 
                             | cth composition is determined by difference. Additionally the subdivision ranges
                             | are applied sequentially, with compositions that violate mass balance (sum of
                             | compositions > 1) eliminated as they occur. Thus, in general, users have the greatest
                             | control on the composition of the first species on a site and no direct control
                             | on the composition of the last species. Since in most cases it is desired to 
                             | restrict the composition of dilute species, endmembers should be specified 
                             | (READ 4) so that the dilute species is not the last species.

begin_excess_function
                             | format is W(e1 e1 e2 ...) num1 num2 num3
                             | where the excess parameter = num1 + num2*T + num3*P
                             | and is multiplied by y(e1)*y(e1)*y(e2)...
W(phl ann) 9000. 0. 0.  
W(phl east) 10000. 0. 0.  
W(phl obi) 3000. 0. 0. 
W(ann east)  -1000. 0. 0.  
W(ann obi) 6000. 0. 0. 
W(obi east)  10000.  0. 0. 

end_excess_function 

3                           | Configurational entropy: 3 sites, M1, M2, T1.

4 1.                        | 4 species on M1, 1 site per formula unit.

                            | If a mixing site involves n species, VERTEX
                            | expects to find n-1 site fraction definitions 
                            | in terms of the endmember fractions. These
                            | definitions have the general format:
                            | text = num + num1 * name1 + num2 * name2
                            | where num is a number or fraction (i.e., two
                            | numbers separated by a '/') and name is the 
                            | name of a valid endmember.
                              

                            | WARNING! fractions can only be used in the site
                            | fraction definitions, do not use fractions to specify
                            | site multiplicities in the above line.
z(m1,fe) = 1 ann  + 1 obi   
z(m1,mg) = 1 phl           
z(m1,mn) = 1 mnbi


3 2.                        | 3 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann  
z(m2,mn) = 1 mnbi       

2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,si) = 0.5 phl +0.5 ann +0.5 obi +0.5 mnbi  

end_of_model   
                    --------------------------------------------------------  
begin_model                         

                                  Ti-Biotite model after White, Powell & Holland (JMG, 2007)

                                  Model entered by Lucie Tajcamanova, May 11, 2007. 

                                  DQF corrections to annite added, Mark Caddick, Nov, 2007.




                                  NOTE: this model requires make defintions for fbi and tbi
                                  in the thermodynamic data file.


                                                      1       2      3      4
                                                      M1      M2     T1     H
                                                     ____________________________

                                      Mutliplicity    1       2      2      2 
                                                     ____________________________

                          Dependent:  1 ffbi          Fe3+    Fe     AlAl   OH  
                                      2 fbi           Fe3+    Mg     AlAl   OH
                          
                          Dependent:  3 ftbi          Ti      Fe     AlSi   O
                                      4 tbi1          Ti      Mg     AlSi   O
   
                          Dependent:  5 Sdph          Al      Fe     AlAl   OH
                                      6 East          Al      Mg     AlAl   OH

                            Species:  7 Ann           Fe      Fe     AlSi   OH
                                      8 Phl           Mg      Mg     AlSi   OH
                                                      __________________________

                            Ordered:  9 Obi           Fe      Mg     AlSi   OH


                       

TiBio(WPH)                   | solution name.

8                            | model type: Margules with dependent endmembers and speciation.

2                            | the number of independent subcompositions, reciprocal solution if > 1.

2  4                         | 2 species on site 1, 4 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mg-Fe and the species that mix on 
                             | site 2 are M2+, Al, Ti. Fe3+. The identity of M2+ on site 2 is determined by
                             | the identity of the M2+ cation on site 1

ffbi_i   fbi
ftbi_i   tbi1
sdph_i   east                | endmember names    
ann      phl                 
        
1                            | ordered species:

obi = 2/3 phl + 1/3 ann   enthalpy_of_formation = -10.73d3  

3                            | 3 dependent endmembers 

                              
sdph_i = 1 east  + 1 ann - 1 obi 
ffbi_i = 1 fbi   + 1 ann - 1 obi
ftbi_i = 1 tbi1  + 1 ann - 1 obi

0 0 0 0 0 0 0 0 0            | endmember flags: if 0 the endmember is considered to be part of the solution.
                   
                             | subdivision model for (binary) site 1 (M2):


0. 1.  .1  0                 | range and resolution of X(Fe)

                             | subdivision model for (quinary) site 2 (M1)
0. 0.2 .1  1                 | range and resolution of X(Fe3+,M1)
0. 0.2 .1  1                 | range and resolution of X(Ti,M1)
0. 1. .1   0                 | range and resolution of X(Al,M1)              

                             


begin_excess_function
                             | current preferred thermocalc values, Caddick, Nov '07

W(phl ann)   9000. 0. 0.     
W(phl east) 10000. 0. 0.  
W(phl obi)   3000. 0. 0. 
W(ann east) -1000. 0. 0.  
W(ann obi)   6000. 0. 0.
W(ann fbi)   8000. 0  0 
W(ann tbi1) 10000. 0  0
W(obi east) 10000. 0. 0. 
                             | values from White et al paper and earlier Perple_X verions.
                             | W(phl ann) 12000. 0. 0.       
                             | W(phl east) 10000. 0. 0.  
                             | W(phl obi) 4000. 0. 0. 
                             | W(phl fbi) 0.  0.  0.
                             | W(phl tbi1) 0.  0.  0.
                             | W(ann east)  3000. 0. 0.  
                             | W(ann obi) 8000. 0. 0.
                             | W(ann fbi)   8000.  0  0 
                             | W(ann tbi1)   10000.  0  0
                             | W(obi east)  7000.  0. 0. 

end_excess_function 

4                           | Configurational entropy: 4 sites, M1, M2, T1 H.

5 1.                        | 5 species on M1, 1 site per formula unit.


z(m1,fe) = 1 ann  + 1 obi   
z(m1,mg) = 1 phl           
z(m1,Fe3+) = 1 fbi 
z(m1,Ti) = 1 tbi1  

2 2.                        | 2 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann 
   

2 2.                        | 2 species on T1, 2 site per formula unit.

z(t1,al) = 1/2  + 1/2 east + 1/2 fbi 

2 2.                        | 2 species on H, 2 site per formula unit.

z(h,o) = 1 tbi1 


begin_dqf_corrections
dqf(ann) -3000 0 0
end_dqf_corrections

end_of_model               
                    --------------------------------------------------------  
begin_model                | keyword indicating beginning of a solution model

                             Ti-Fe-Mg-Mn-Biotite with compound formation, Powell and Holland '99 
                             Am Min, extended for Mn-solution.

                             NOTES: 

                             * This model will only function for the MnASH and FASH subsystems
                               if MGO is also used as a component.

                             * Stoichiometric definition of the mnts_i endmember corrected, 2/04. JADC


                                                      1       2      3      
                                                      M1      M2     T2
                                                     _________________________

                                      Mutliplicity    1       2      2 
                                                     _________________________

                          Dependent:  1 mtbi          Ti      MnV    AlSi
                          Dependent:  2 ftbi          Ti      FeV    AlSi
                                      3 tbi           Ti      MgV    AlSi

                                      4 MnTs          Al      Mn     AlAl      
                          Dependent:  5 Sdph          Al      Fe     AlAl
                          Dependent:  6 East          Al      Mg     AlAl

                                      7 MnBi          Mn      Mn     AlSi   
               Species:               8 Ann           Fe      Fe     AlSi
                                      9 Phl           Mg      Mg     AlSi 
                                                      ________________________

                        Ordered Cpd: 10 Obi           Fe      Mg     AlSi



                             | Comments can be placed before character data within a solution 
                             | model as long as they are preceded by the comment marker "|", 
                             | in general comments should not be placed before numerica data, 
                             | but they can be written following numeric data on the same line.

TiBio(HP)                    | solution name.

8                            | model type: Margules with dependent endmembers and speciation.

2                            | the number of independent subcompositions, reciprocal solution if > 1.

3  3                         | 3 species on site 1, 2 species on site 2. this line (see also Sect 1.3.1 
                             | and Sect 4 [READ 3] in vdoc.pdf) defines the geometric
                             | shape of the composition space, in this case a 4 dimensional prism.
                             | the following lines list the endmembers that define the 9 vertices of 
                             | this prism. the geometry can be understood by noting that although 
                             | biotite as 3 subcompositions (refer to the occupancy table above), the
                             | site populations on all 3 sites are determined if the population on any
                             | 2 crystallographic sites. the independent "chemical" subcompositions need
                             | not correspond to the actual crystallographic sites, but in this case
                             | M2 and M1 can be identified as sites 1 and 2, respectively. Thus the
                             | species that mix on site 1 are Mg-Fe-Mn, and the species that mix on 
                             | site 2 are M2+, Al, Ti. The identity of M2+ on site 2 is determined by
                             | the identity of the M2+ cation on site 1, and the vacancy population on
                             | site 1 is determined by the Ti concentration on site 2. If the endmember 
                             | with species i on site 1 and species j on site 2 is written as endmember ij,
                             | then the 9 endmembers will be read in the order: 11, 21, 31, 12, 22, 32,
                             | 13, 23, 33.

mtbi_i   ftbi_i   tbi
mnts_i   sdph_i   east       | endmember names (refer to the above comment, see also Sect 4 [Read 4] in    
mnbi     ann      phl        | vdoc.pdf).
        
1                            | ordered species:

                             | model types 6 and 8 require data defining the
                             | properties of an ordered "species". this species
                             | is defined as a stoichiometric combination of
                             | two independent endmembers and the enthalpy of
                             | formation of the ordered species from the
                             | these independent endmbers. the format for this
                             | data is

                             | name = num_1 * name_1 + num_2 * name_2 text = enthalpy

                             | where name is the arbitrary name of the ordered
                             | species, num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember. text is arbitrary and
                             | enthalpy is the enthalpy of formation of the ordered species.

obi = 2/3 phl + 1/3 ann   enthalpy_of_formation = -10.73d3  

4                            | 4 dependent endmembers 

                             | model types 7 and 8 (reciprocal solutions) use
                             | internal endmembers that are defined as a 
                             | stoichiometric combination of the other endmembers.
                             | the names of these endmembers are arbitrary, but 
                             | here dependent endmembers are highlighted by the 
                             | suffix "_i", this also serves to distinguish the
                             | endmembers from real equivalents that may be 
                             | present in the thermodynamic data file.

                             | the format of this data is

                             | name = num_1 * name_1 + num_2 * name_2

                             | where num_j is a number or fraction (i.e., two
                             | numbers separated by a '/') and name_j is the 
                             | name of a valid endmember.

                             | for theoretical reasons that are too complicated to
                             | explain here (see Powell & Holland 2001), if an ordered
                             | species (e.g., obi) is included in a reciprocal solution
                             | then any dependent endmembers that can be defined in terms
                             | of this dependent endmember must be so defined. 
                             | i.e., here sdph_i must be defined in terms of obi, but
                             | the mnts_i endmember can only be written in terms of 
                             | mnbi and phl.

mnts_i = 1 east + 2/3 mnbi - 2/3 phl  
sdph_i = 1 east + 1 ann - 1 obi 
mtbi_i = 1 tbi  + 1/3 mnbi - 1/3 phl
ftbi_i = 1 tbi  + 1/2 ann - 1/2 obi

0 0 0 0 0 0 0 0 0            | endmember flags: if 0 the endmember is considered to be part of the solution.
                   
                             | subdivision model for (ternary) site 1 (M2):

0. .2  .1  1                 | range and resolution of X(Mn)
0. 1.  .1  0                 | range and resolution of X(Fe)

                             | subdivision model for (ternary) site 2 (M1)
0. 1. .1   1                 | range and resolution of X(Ti,M1)
0. 1. .1   0                 | range and resolution of X(Al,M1)                        

                             | the foregoing lines define the pseudocompound compositions generated
                             | on each "chemical" mixing site of the solution (Sect 4 [READ 6] vdoc.pdf).
                             | for each site the compositional "range" of c-1 species (c is the number of 
                             | species on the site as defined in READ 3) is specified as well as a scheme 
                             | for interpreting the range. each range is defined by 3 numbers XMIN, XMAX, 
                             | and XINC, and the scheme is specified by an integer (IMD) written after the 
                             | c-1 ranges. The simplest scheme is cartesian, in which case IMD = 0 and the
                             | the XMIN, XMAX, and XINC indicate the range of compositions (from XMIN to XMAX) 
                             | of the respective c-1 species and the compositional spacing (XINC) of the 
                             | pseudocompounds. As entered above, the subdivision scheme will generate 
                             | pseudocompounds with X(Mn) on site 1 from 0 to 0.20 mol at 0.01 mol increments
                             | for each X(Mn) isopleth, compounds will be generated with X(Fe) from 0 to 1-X(Mn),
                             | where "0" and "1" correspond to XMIN and XMAX in the range for the second species
                             | on site 1, and X(Mg) = 1 - X(Fe) - X(Mn).

                             | Alternative subdivision shemes detailed in vdoc.pdf, may be useful for specialized
                             | applications, e.g., creating models with variable compositional resolution.

                             | By restricting the ranges specified in a model it is possible to focus pseudocompounds
                             | over a particular portion of a solutions composition space, such focusing can be 
                             | computationally advantageous when it is known a priori that only a limited range of
                             | compositions can be stable, but it should be undertaken with caution because the 
                             | results are not always easy to anticipate. 

                             | The primary difficulty in restricting compositional ranges is that the user 
                             | can explicitly control the composition of only c-1 compositions since the 
                             | cth composition is determined by difference. Additionally the subdivision ranges
                             | are applied sequentially, with compositions that violate mass balance (sum of
                             | compositions > 1) eliminated as they occur. Thus, in general, users have the greatest
                             | control on the composition of the first species on a site and no direct control
                             | on the composition of the last species. Since in most cases it is desired to 
                             | restrict the composition of dilute species, endmembers should be specified 
                             | (READ 4) so that the dilute species is not the last species.


begin_excess_function

                             | format is W(e1 e1 e2 ...) num1 num2 num3
                             | where the excess parameter = num1 + num2*T + num3*P
                             | and is multiplied by y(e1)*y(e1)*y(e2)...

W(phl ann) 9000. 0. 0.  
W(phl east) 10000. 0. 0.  
W(phl obi) 3000. 0. 0. 
W(phl tbi)  -10000.  0.  0.
W(ann east)  -1000. 0. 0.  
W(ann obi) 6000. 0. 0. 
W(ann tbi)   12000.  0  0
W(obi east)  10000.  0. 0. 

end_excess_function 

3                           | Configurational entropy: 3 sites, M1, M2, T1.

5 1.                        | 4 species on M1, 1 site per formula unit.

                            | If a mixing site involves n species, VERTEX
                            | expects to find n-1 site fraction definitions 
                            | in terms of the endmember fractions. These
                            | definitions have the general format:
                            | text = num + num1 * name1 + num2 * name2
                            | where num is a number or fraction (i.e., two
                            | numbers separated by a '/') and name is the 
                            | name of a valid endmember.
                              
                            | WARNING! fractions can only be used in the site
                            | fraction definitions, do not use fractions to specify
                            | site multiplicities in the above line.

z(m1,fe) = 1 ann  + 1 obi   
z(m1,mg) = 1 phl           
z(m1,mn) = 1 mnbi
z(m1,al) = 1 east 

4 2.                        | 4 species on M2, 2 sites per formula unit.

z(m2,fe) = 1 ann 
z(m2,mn) = 1 mnbi 
z(m2,vac) = 1/2 tbi     

2 2.                        | 2 species on T1, 2 site per formula unit.
z(t1,al) = 1/2  + 1/2 east 

end_of_model               | end of model keyword            
                    -------------------------------------------------------- 
begin_model                
                           | CHLORITE: extended from holland et al. 1998, EJM.

                              
                             NOTES:  

                             * This model will only function for the FASH subsystem
                               if MGO is also used as a component in VERTEX.
                                           
                             * This model was tested with the maple script compete_chl.mws

                             * For normal aluminous chlorites there is little to be gained
                               by considering the afchl endmember becuase the 
                               endmember has negligible contribution to the total energy of 
                               the solution (see fig 4 of holland et al). Exclude this 
                               endmember to save computational resources. For Al-poor
                               systems exclude ames and retain afchl.


                             JADC 4/03


                           | Despite this models complexity it can be 
                           | written as a simple ternary with one independent
                           | ordering parameter, however perplex does not 
                           | yet have speciation models implemented for
                           | solutions in which multiple endmembers are 
                           | characterized by a single ordering parameter.
                           | hence the model is formulated here explicitly
                           | in terms of the dependent endmembers with the
                           | site occupancy table:


                                                      1         2       3      4
                                                      M1      M2+M3     M4     T2
                                                     ________________________________

                                      Mutliplicity    1         4       1      2 
                                                     ________________________________
  
                                      1 mame          Al        Mn      Al     Al_Al   dependent
                                      2 mafchl        Mn        Mn      Mn     Si_Si   dependent
                                      3 mnchl         Mn        Mn      Al     Al_Si    
                                      4 fames         Al        Fe      Al     Al_Al   dependent
                                      5 fafchl        Fe        Fe      Fe     Si_Si   dependent
                                      6 daph          Fe        Fe      Al     Al_Si  
                                      7 ames          Al        Mg      Al     Al_Al
                                      8 afchl         Mg        Mg      Mg     Si_Si
                                      9 clin          Mg        Mg      Al     Al_Si     
 
                                          Dependent endmembers:

                                          fame = ames + 4/5 * (daph - clin) 
                                          fafchl = afchl + 6/5 * (daph - clin) 
                                          mame = ames + 4/5 * (mnchl - clin) 
                                          mafchl = afchl + 6/5 * (mnchl - clin) 

                           | For normal aluminous chlorites there is little to be gained
                           | by considering the afchl and fafchl endmembers 
                           | becuase the endmember has negligible 
                           | contribution to the total energy of the solution
                           | (see fig 4 of holland et al)


Chl(HP)     
                       
7                               | model type reciprocal, macroscopic formulation
2 
3 3 
mame_i   mafchl_i mnchl
fame_i   fafchl_i daph
ames     afchl    clin

4                               | 4 dependent endmembers 

fame_i   = 1 ames   + 4/5 daph  - 4/5 clin
fafchl_i = 1 afchl  + 6/5 daph  - 6/5 clin
mame_i   = 1 ames   + 4/5 mnchl - 4/5 clin
mafchl_i = 1 afchl  + 6/5 mnchl - 6/5 clin

1 1 1 0 0 0 0 0 0            |endmember flags

                             | subdivision model for (ternary) site 1 (T2):
0. 1. .1 0                   | range and resolution of X(Al_Si), imod = 0 -> cartesian subdivision
0. 1. .1 0                   | range and resolution of X(Al_Al), imod = 0 -> cartesian subdivision
                             | subdivision model for (ternary) site 2 (M2)

0. .2  .1 1                  | range and resolution of X(Mn), imod = 1 => asymmetric subdivision
0. 1.  .1 0                  | range and resolution of X(Fe), imod = 0 -> cartesian subdivision 

begin_excess_function

w(clin ames) 18000. 0. 0. 
w(clin afchl) 18000. 0. 0. 
w(ames afchl) 20000. 0. 0. 
w(clin daph) 2500. 0. 0.  
w(daph ames) 13500. 0. 0. 
w(daph afchl) 14500. 0. 0. 

end_excess_function

4                               |4 site configurational entropy model:

4 1.                            |4 species on 1 M1 site

z(al,M1) = 1 ames 
z(mg,M1) = 1 clin + 1 afchl
z(fe,M1) = 1 daph 


3 4.                            |3 species on 4 M2+M3 sites

z(mg,m2+m3)= 1 clin + 1 ames + 1 afchl
z(fe,m2+m3)= 1 daph 


2 1.                            |2 species on 1 M4 site

z(mg,m4) = 1 afchl


2 2.                            |2 species on 2 T2 sites 
z(al,T2)= 1 ames + 1/2 clin + 1/2 daph + 1/2 mnchl

end_of_model  
                              --------------------------------------------------------
begin_model                
                                      Sack & Ghiorso (1989 CMP 102:41-68) for Fe-Mg olivine. 
                                      [an astoundingly complex presentation]
                                      JADC 7/03         

O(SG)     
2                                     model type margules, macroscopic                                                                         

2                                     2 endmembers

fo 
fa

0  0                               | endmember flags

0. 1. 0.1 0                        | range and resolution of X(mg), imod = 0 -> cartesian subdivision

begin_excess_function   
w(fo fa)  20314. 0. 3e-2    
end_excess_function

1                                     1 site entropy model (m)
2 2.                                  2 species on m2, mutiplicity = 2
z(m,mg) = 1 fo

end_of_model                  
                              --------------------------------------------------------
begin_model                   

                                      This is the Sack & Ghiorso (1989 CMP 102:41-68) 
                                      noncovergent ordering model for Fe-Mg opx. The model
                                      has been reformulated as a compound formation
                                      model for Perple_X.

                                      JADC 7/03


                                                        Sites
                
                                                      M1     M2               
                                                     ______________           

                                      Mutliplicity     1      1      
                                                     ______________            
                                                     
                                      1 en            Mg     Mg               
                            Species:  2 fs            Fe     Fe                         
                                                      ______________           

                        Ordered Cpd:  3 opx           Mg     Fe            



E(SG)     
6                                     model type margules with compound formation                                                                         

2                                   | 2 endmembers

en 
fs

1                                   | ordered species definition

opx = 1/2 en + 1/2 fs enthalpy_of_formation = -16d3 

0  0                                 endmember flags

0. 1. 0.1  0                   | range and resolution of X(mg), imod = 0 -> cartesian subdivision

begin_excess_function   
w(en fs)   26000. 0. 0.  
w(en opx)  16000. 0. 0.  
w(fs opx)  16000. 0. 0.  
end_excess_function

2                                     2 site entropy model (m1, m2)
2 1.                                  2 species on m2, mutiplicity = 1
z(m1,mg) = 1 en + 1 opx
2 1.                                  2 species on m1, mult. = 1
z(m2,mg) = 1 en 


end_of_model                 
                              --------------------------------------------------------
begin_model                  
                                      HP '96 Am Min, Non-ideal quasi ordered omphacite,
                                      i.e., compound formation only occurs for omph.
                                      This model should only be used in conjunction with 
                                      Cpx(HP). The value of wdh appears discrepant 
                                      with the value in HP '98.

                                      The interaction parameters here are from the
                                      Omphacite model distributed with the '00 
                                      Thermocalc program.

                                      JADC 2/03

                                      CORRECTIONS:

                                      enthalpy of ordering corrected from -16 kJ to
                                      -3.5 kJ. JADC, Aug 20, 2003.


                                                         Site:
                                                       1      2      3      4
                                                      M2a    M2b    M1a    M1b
                                                     _________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2 
                                                     _________________________

                                      1 Diopside      Ca     Ca     Mg     Mg
                            Species:  2 Jadeite       Na     Na     Al     Al
                                      3 Hedenbergit   Ca     Ca     Fe     Fe
                                                      ________________________

                        Ordered Cpd:  4 Omphacite     Na     Ca     Al     Mg



Omph(HP)     
6                                     model type margules with compound formation                                                                         

3                            | 3 endmembers
di       
jd       
hed

1                            | ordered species definition

omph = 1/2 jd + 1/2 di enthalpy_of_formation = -35d2 

0  0  0                      | endmember flags

0. 1. 0.1 0                  | range and resolution of X(di), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                  | range and resolution of X(jd), imod = 0 -> cartesian subdivision

begin_excess_function   
w(di jd)    26000. 0. 0.  
w(omph jd)  16000. 0. 0.  
w(omph di)  16000. 0. 0. 
w(omph hed) 17000. 0. 0. 
w(hed jd)   24000. 0. 0. 
w(di hed)   4000.  0. 0.       | hp 98 give 2.5 kJ
end_excess_function

4                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

2 0.5                               | 2 species on m2a, mutiplicity = 1/2

                                    | WARNING! fractions can only be used in the site
                                    | fraction definitions, do not use fractions to specify
                                    | site multiplicities in the above line.

z(m2a,ca) = 1 di + 1 hed 

2 0.5                                 2 species on m2b, mult. = 1/2
z(m2a,na) = 1 jd 

3 0.5                                 3 species on m1a, mult = 1/2
z(m1a,mg) = 1 di 
z(m1a,fe) = 1 hed

3 0.5                                 3 species on m1b, mult = 1/2
z(m1b,al) = 1 jd
z(m1a,fe) = 1 hed

end_of_model               
                              --------------------------------------------------------
begin_model                   
                                      Holland and Powell (2001) J.Petrol 426, 673-683 (KNCASH)
                                      White et al (2001) JMG 19: 139-153 (FM+KNCASH). Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      JADC 3/03

                                      Changed DQF terms to account for modifications of faL and foL 
                                      (White et al 2007). Mark Caddick, Nov, 07.


                                      WARNING 1: This model can only be used for hydrous systems  
                                      if H2O is specified as a thermodynamic component or as a
                                      staurated component, it CANNOT be used if water is specified
                                      as a saturated phase component (i.e., if H2O is specified as a saturated 
                                      phase component, VERTEX will reject the H2OL endmember
                                      and the model will be applicable only to dry melts).

                                      WARNING 2: DO NOT CHANGE THE ORDER OF THE FIRST 3 ENDMEMBERS
                                      this model uses an internal routine to compute the
                                      entropy of the melt that assumes the order entered
                                      here, see comments with endmember names below.

                                      WARNING 3: the endmembers q8L, fa8L, fo8L, and
                                      sil8L must be "made" in the thermodynamic data
                                      file. See the header section of hp02ver.dat for
                                      details on the "make" structure.

                                      WARNING 3.1: the (stabilizing) dqf corrections made
                                      to the fo8L, fa8L, and sil8L enedmembers make the 
                                      haplogranite melt model inapplicable to melts where
                                      these endmembers are present in high concentrations,
                                      to model such situations or to reproduce the published
                                      fo-fa-q or sil-q melting phase relations, the dqf corrections
                                      (below) should be set to zero. 


                                      WARNING 4: different versions of the HP data base
                                      may result in significant variations in the predicted
                                      position of the wet-solidus (Powell, pers comm.).


                                      WARNING 5: The melt model incorrectly predicts a high 
                                      pressure-low temperature stability field for water-silica
                                      rich melts. at 10 kb this field extends to ca 750 K and 
                                      at 3 kb to ca 550 K. For this reason the melt model should
                                      not be used at pressures far above 10 kb.

                                      
                                      WARNING 6: the subdivision ranges below may not
                                      span the entire range of validity for the solution
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.

melt(HP)
24                                    model type: margules, internal entropy routine

8                                     number of endmembers
                                 
                                    | ENDMEMBER NAMES:                               

h2oL                                | Because this model uses an internal routine to compute the
                                    | entropy of the melt h2oL must be the specified as the first
                                    | endmember (See WARNING 2 in the header of this model).

                                    | fo8 and fa8 must be the 2nd and 3rd endmembers, but their
fo8L     fa8L                       | relative order is arbitrary.

abL      sil8L    anL               | The relative order of these endmembers is arbitrary.
kspL     q8L                         

 0 0 0 0 0 0 0 0                    | endmember flags.  

                                    | RESTRICTED(!) subdivision ranges and model
                                    | the ranges must be extended if calculations
                                    | are to be done in subsystems like fo-fa-h2o,
                                    | Ab-H2O etc etc; these numbers seem about right
                                    | for pelite melting.

0.0 0.8  0.1 0                      | range and resolution of X(h2o), 0 => cartesian subdivision  
0.0 0.1  0.1 1                      | range and resolution of X(fo),  1 => asymmetric subdivision   
0.0 0.1  0.1 1                      | range and resolution of X(fa),  1 => asymmetric subdivision   
0.0 0.4  0.1 0                      | range and resolution of X(ab),  0 => cartesian subdivision   
0.0 0.2  0.1 1                      | range and resolution of X(sil), 1 => asymmetric subdivision  
0.0 0.1  0.1 1                      | range and resolution of X(an),  1 => asymmetric subdivision   
0.0 0.4  0.1 0                      | range and resolution of X(ksp), 0 => cartesian subdivision

begin_excess_function 
                                    | the excess parameters used for the haplo-
                                    | granite melt model vary between papers (notably w(an-sil)),
                                    | the values here are from the thermocalc
                                    | model file 'thdmloss.txt' and appear largely
                                    | consistent with the white et al paper.

w(q8L    anL) -10d3 0.  0.  
w(q8L  sil8L) 12d3  0.  0. 
w(q8L    abL) 12d3  0. -0.4      
w(q8L   kspL) -2d3  0. -0.5               
w(q8L   h2oL) 15d3  0.  0.  
w(q8L   fo8L) 12d3  0. -0.4  
w(q8L   fa8L) 14d3  0.  0.
w(abL  sil8L) 12d3  0.  0. 
w(abL   kspL) -6d3  0.  3.
w(abL   fo8L) 10d3  0.  0.
w(abL   fa8L)  2d3  0.  0.
w(abL   h2oL)  1d3  0. -0.2
w(kspL   anL)   0   0. -1.    
w(kspL sil8L) 12d3  0.  0.
w(kspL  h2oL) 11d3  0. -0.45     
w(kspL  fo8L) 12d3  0.  0.
w(kspL  fa8L) 12d3  0.  0.
                                    | w(anL sil8) is 12 kJ in the Holland & Powell J Pet paper
                                    | but appears to have accidentally been set to zero
                                    | for the calculations published in the White et al. JMG
                                    | paper. To restore this parameter delete the comment 
                                    | marker "|" on the following line:
                                    | w(anL sil8) 12d3  0.  0.            
w(anL   h2oL)  9d3 0. -0.85
w(sil8L fo8L) 12d3 0. 0.
w(sil8L fa8L) 12d3 0. 0. 
w(sil8L h2oL) 16d3 0. 0.     
w(fo8L  fa8L) 18d3 0. 0.
w(fo8L  h2oL) 11d3 0. -0.5
w(fa8L  h2oL) 12d3 0. 0. 

end_excess_function 

  0                                  | no configurational entropy model (internal routine hpmelt).

begin_dqf_corrections
dqf(fo8L)  -10d3 0 0 
dqf(fa8L)  -9d3 0 -1.3
dqf(sil8L) -10d3 0 0
                                     | pre-white et al '07 value: dqf(fo8L)  -15d3 0 0 
                                     | pre-white et al '07 value: dqf(fa8L)  -15d3 0 0
                                     | pre-white et al '07 value: dqf(sil8L) -10d3 0 0
end_dqf_corrections

end_of_model    
                                      --------------------------------------------------------
begin_model                          | keyword indicating beginning of a solution model

                                      Ghiorso et al (2002) G3 v. 3 (n. 5) model for mantle
                                      melting, 1-3 GPa. Read cautionary notes in Ghirso for
                                      applications beyond this pressure range. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the pMELTS model that excludes
                                      the Cr-, Ni-, Co-, and P-bearing melt components. The melt
                                      endmember names have been changed from those used in the pMELTS paper.

                                      This model should be applied with solid phase data 
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the 
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the pMELTS model, however using these files 
                                      will almost certainly result in inconsistencies with published
                                      pMELTS results.


                                      JADC 7/03


                                      WARNING 1: This model can only be used for hydrous systems  
                                      if H2O is specified as a thermodynamic component
                                      (i.e., if H2O is specified as a saturated 
                                      component, VERTEX will reject the h2oG(L) endmember
                                      and the model will be applicable only to dry melts).

                                      WARNING 2: this model uses an internal routine to 
                                      compute the entropy of the melt that assumes 
                                      h2oG(l) is the first endmember.

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the pMELT
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.

                                      ====================================================
                                      Modified to use pure water at P and T standard
                                      state (the H2O endmember) as opposed to the h2oGL 
                                      endmember of Ghiorso et al. (2003), which so far 
                                      as I understand should  be equivalent. 

                                      NOTE: Use of H2O as an endmember requires the user
                                      specify an equation of state for H2O when running
                                      BUILD. To be strictly consistent with Ghiorso et al
                                      the Sterner and Pitzer EoS for water should be used 
                                      for this purpose, but it is not presently included
                                      in perplex. Instead of the Sterner-Pitzer EoS i would
                                      recommend using the CORK EoS, which differs negligibly
                                      from the Sterner-Pitzer EoS.

                                      JADC May 23, 2004.
                                      

pMELTS(G)
25                                    model type: margules, internal entropy routine

8                                     number of endmembers

H2O                                 | h2o MUST be the first endmember, see WARNING 1 above.
foGL
faGL
woGL
kalGL
nasGL
coGL
qGL            

1 0 0 0 0 0 0 0                     | endmember flags  

                                    | NOTE restricted compositional ranges!                 

0.0 1.0   0.1  0                    | range and resolution of X(h2o), 0 => cartesian subdivision  
0.0 0.5   0.1  0                    | range and resolution of X(fo), 0 => cartesian subdivision    
0.0 0.2   0.1  0                    | range and resolution of X(fa), 0 => cartesian subdivision     
0.0 0.2   0.1  0                    | range and resolution of X(wo), 0 => cartesian subdivision  
0.0 0.6   0.1  0                    | range and resolution of X(kal), 0 => cartesian subdivision     
0.0 0.6   0.1  0                    | range and resolution of X(nas), 0 => cartesian subdivision    
0.0 0.2   0.1  0                    | range and resolution of X(co), 0 => cartesian subdivision  

begin_excess_function 
w( coGL  qGL  ) -296975.2 0. 0.
w( faGL  qGL  ) -18841.4  0. 0.
w( foGL  qGL  ) -33833.5  0. 0.
w( woGL  qGL  ) -34232.9  0. 0.
w( nasGL qGL  ) -59822.7  0. 0.
w( kalGL qGL  ) -102706.5 0. 0.
w( H2O   qGL  ) -45181.6  0. 0.
w( faGL  coGL ) -200788.1 0. 0.
w( foGL  coGL ) -192709.0 0. 0.
w( woGL  coGL ) -270700.8 0. 0.
w( nasGL coGL ) -205068.6 0. 0.
w( kalGL coGL ) -114506.5 0. 0.
w( H2O   coGL ) -161944.4 0. 0.
w( foGL  faGL ) -28736.4  0. 0.
w( woGL  faGL ) -28573.8  0. 0.
w( nasGL faGL ) -4723.9   0. 0.
w( kalGL faGL ) 22245.0   0. 0.
w( H2O   faGL ) 9769.4    0. 0.
w( woGL  foGL ) 574.1     0. 0.
w( nasGL foGL ) 9272.3    0. 0.
w( kalGL foGL ) 36512.7   0. 0.
w( H2O   foGL ) 24630.1   0. 0.
w( nasGL woGL ) 7430.3    0. 0.
w( kalGL woGL ) 19927.4   0. 0.
w( H2O   woGL ) -1583.7   0. 0.
w( kalGL nasGL) -1102.3   0. 0.
w( H2O   nasGL) 13043.1   0. 0.
w( H2O   kalGL) 35572.8   0. 0.
end_excess_function 
  0                                  | no configurational entropy model (internal routine gmelt).
end_of_model                         
                                      --------------------------------------------------------
begin_model                         
                                      Ghiorso & Sack (1995) CMP 119:197-212 (the MELTS model)
                                      Read cautionary notes in Ghirso. Calculations
                                      with this model can be sped up significantly by restricting
                                      the subdivsion ranges specified below.

                                      This is a reduced version of the MELTS model that excludes
                                      the Cr- and P-bearing melt components. The melt
                                      endmember names have been changed from those used 
                                      in the MELTS paper.

                                      This model should be applied with solid phase data 
                                      and solution models from the MELTS program. The melt
                                      endmember data converted to PERPLE_X format is in the 
                                      file pMELTSver.dat. The PERPLE_X solid phase data files
                                      b92ver.dat and hp98ver.dat also include this data and therefore
                                      can be used with the MELTS model, however using these files 
                                      will almost certainly result in inconsistencies with published
                                      MELTS results.


                                      JADC 7/03


                                      WARNING 1: This model can only be used for hydrous systems  
                                      if H2O is specified as a thermodynamic component
                                      (i.e., if H2O is specified as a saturated 
                                      component, VERTEX will reject the h2oGM endmember
                                      and the model will be applicable only to dry melts).

                                      WARNING 2: this model uses an internal routine to 
                                      compute the entropy of the melt that assumes 
                                      h2oGM is the first endmember.

                                      WARNING 3: the subdivision ranges below may not
                                      span the entire range of validity for the MELT
                                      model. Check these ranges, and adjust them as 
                                      necessary before using this model.
                                      

MELTS(GS)
25                                    model type: margules, internal entropy routine

8                                     number of endmembers

h2oGM
foGM
faGM
woGM
kalGM
nasGM
coGM
qGM            

0 0 0 0 0 0 0 0                  | endmember flags                  

0.0 0.3  0.04 0  
0.3 0.7  0.04 0 
0.0 0.3  0.04 0  
0.0 0.2  0.04 0
0.0 0.4  0.04 0  
0.0 0.2  0.04 0 
0.0 0.3  0.04 0                   | (restricted) subdivision ranges and model

begin_excess_function 
                   
w( coGM  qGM  ) -39120.   0. 0.
w( faGM  qGM  ) 23661.    0. 0.
w( foGM  qGM  ) 3421.     0. 0.
w( woGM  qGM  ) -864.     0. 0.
w( nasGM qGM  ) -99039.   0. 0.
w( kalGM qGM  ) -33922.   0. 0.
w( h2oGM qGM  ) 30967.    0. 0.
w( faGM  coGM ) -30509.   0. 0.
w( foGM  coGM ) -32880.   0. 0.
w( woGM  coGM ) -57918.   0. 0.
w( nasGM coGM ) -130785.  0. 0.
w( kalGM coGM ) -25859.   0. 0.
w( h2oGM coGM ) -16098.   0. 0.
w( foGM  faGM ) -37257.   0. 0.
w( woGM  faGM ) -12971.   0. 0.
w( nasGM faGM ) -90534.   0. 0.
w( kalGM faGM ) 23649.    0. 0.
w( h2oGM faGM ) 28874.    0. 0.
w( woGM  foGM ) -31732.   0. 0.
w( nasGM foGM ) -41877.   0. 0.
w( kalGM foGM ) 22323.    0. 0.
w( h2oGM foGM ) 35634.    0. 0.
w( nasGM woGM ) -13247.   0. 0.
w( kalGM woGM ) 17111.    0. 0.
w( h2oGM woGM ) 20375.    0. 0.
w( kalGM nasGM) 6523.     0. 0.
w( h2oGM nasGM) -96938.   0. 0.
w( h2oGM kalGM) 10374.    0. 0.
end_excess_function 

  0                                  | no configurational entropy model (internal routine gmelt).

end_of_model                         
                  --------------------------------------------------------
begin_model                         
                                      holland and powell '98 non-ideal cz-fep solution

                                                      1       2           
                                                      M1      M3     
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 cz            Al      Al       
                            Species:  2 fep           Fe      Fe      
                                                      _____________

                        Ordered Cpd:  3 ep            Al      Fe    


                   
Ep(HP)
6                          | model type: Margules, speciation           
2                          | 2 endmembers                                        
cz       fep               | endmember names 

1                          | ordered species definition

ep = 1/2 fep + 1/2 cz Delta(enthalpy) = -13.05d3     
 
0 0 0                      | endmember flags
0. 1. 0.1  0               | range and resolution for X(cz), imod = 0 -> cartesian subdivision

begin_excess_function 
w(cz fep) 15400.0 0. 0. 
w(fep ep) 3000.0  0. 0. 
end_excess_function

2                          | 2 site (M1, M3) configurational entropy model

2 1.                       | 2 species on M1, 1 site per formula unit.
z(fe,m1) = 1 fep

2 1.                       | 2 species on M3, 1 site per formula unit.
z(al,m3) = 1 cz 

end_of_model               
                      --------------------------------------------------------
begin_model               
                             Phengite as http://www.esc.cam.ac.uk/astaff/holland/ds5/muscovites/mu.html 
                             This model assumes M2 (multiplicity 2) is split into 1 M2a site on
                             which tri- and di-valent cations mix, and an M2b site occupied
                             solely by Al.
                                 
                             JADC 2/03

                             config entropy corrected, D Tinkham, 5/6/03



   
                                                      A       M2a      T1
                                                     _________________________

                                      Mutliplicity    1       1         2 
                                                     _________________________

                                      1 mu            K       Al       Al_Si   
                            Species:  2 cel           K       Mg       Si_Si
                                      3 fcel          K       Fe       Si_Si  
                                      4 pa            Na      Al       Al_Si



                                      this model makes a dqf correction for paragonite 
                                      (meaning that this model is not valid for Na-rich 
                                      compositions).


Pheng(HP)                             | solution name 
2                                     | model type: Margules, endmember fractions
4                                     | 4 species 

pa                                    | endmember names 
cel      fcel        mu               | endmember names 


1 0 0 0                               | endmember flags

0. 1. 0.1 0                           | range and resolution for x(pa), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                           | range and resolution for x(cel), imod = 0 -> cartesian subdivision  
0. 1. 0.1 0                           | range and resolution for x(fcel), imod = 0 -> cartesian subdivision  

begin_excess_function 
w(mu pa)   12d3  0.   0.4
w(cel pa)  14d3  0.   0.2
w(fcel pa) 14d3  0.   0.2
end_excess_function 

3                          | 3 sites (A, M2, T1) configurational entrpoy model

2 1.                       | 2 species on A, 1 site per formula unit.
z(A,Na) = 1 pa 

3 1.                       | 3 species on M2a, 1 sites per formula unit.
z(m2,Mg) = 1 cel
z(m2,Fe) = 1 fcel   

2  2.                      | 2 species on T1, 2 sites per formula unit.

z(T1,Si) = 1/2 mu + 1/2 pa

begin_dqf_corrections
                           | for endmember "name" the dqf correction is 
                           | entered as 
                           | dqf(name) num1 num2 num3
                           | where the dqf correction to the endmembers 
                           | Gibbs energy is computed as 
                           | Gdqf(J/mol) = num1 + T[K]*num2 + P[bar]*num3
dqf(pa) 1420 0 0.4 
end_dqf_corrections

end_of_model               
                      --------------------------------------------------------
begin_model                
                            Sapphirine, ideal, holland and powell '98 

                            config entropy corrected, P Goncalves/JADC, 10/1/03

                            the corrected model assumes (after the text on TJBH's
                            saphhirine web page www.esc.cam.ac.uk/astaff/holland/ds5/sapphirines/spr.html)
                            that:

                                   1) a 14 cation unit formula
                                   2) Si occupies T2, Al occupies T5, Si and Al mix on
                                      remaining 4 sites T1 T3 T4 T6 (the T site below)
                                   3) Al occupies M7; only Fe and Mg may occupy sites
                                      M4, M5, M6 (Site MB below); Al, Mg, and Fe may occupy 
                                      sites M1, M2, M3 and M8 (Site MA below)
                              
                             N.B. This model seems to differ from the Thermocalc format version on 
                             TJBH's web page in that it accounts for the configurational entropy
                             arising from mixing on MB (i.e., the Thermocalc model looks like it
                             was written for Fe-free sapphirine). Eliminate site MB to reproduce 
                             the TJBH web page Thermocalc model.

               
                                                      1      2     3           
                                                      MA     MB    T     
                                                     _________________

                                      Mutliplicity    4      3     4
                                                     _________________

                                      1 spr7          MgAl7  Mg    SiAl7
                            Species:  2 fspr          FeAl7  Fe    SiAl7
                                      3 spr4          MgAl3  Mg    SiAl3
                                      4 fsp4_i        FeAl3  Fe    SiAl3      


                                      Dependent endmember:

                                      fsp4_i = spr4 +  8/7 * (fspr - spr7) 


Sapp(HP)

7                                     model type 
2                                     reciprocal solution
2 2                                   2 species on each site
spr7     fspr        
spr4     fsp4_i
1                                     1 dependent endmember 
fsp4_i = 1 spr4 +  8/7 fspr - 8/7 spr7

0  0  0  0                            endmember flags

0. 1. 0.1  0               | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0. 1. 0.1  0               | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (MA, MB, T) configurational entropy model

2 3.                       | 2 species on MB, 3 sites per formula unit
z(mb,mg) = 1 spr4 + 1 spr7

3 4.                       | 3 species on MA, 4 sites per formula unit.
z(ma,Al) = 3/4 + 1/8 spr7 + 1/8 fspr
z(ma,fe) = 1/8 fspr

2 4.                       | 2 species on T, 4 sites per formula unit.
z(T,Al) = 3/4 + 1/8 spr7 + 1/8 fspr

end_of_model               
                      --------------------------------------------------------
begin_model                
                            Sapphirine, non-ideal, Kelsey et al. (J. metamorphic Geol., 2004, 22, 559-578)

                            NOTE: This model should be used in conjunction with a special
                            high temperature version of the HP data base (kel04ver.dat).

                            Model originally entered by Pulak Sengupta, 7/16/05. 
               
                                                      1      2     3           
                                                      MA     MB    T     
                                                     _________________

                                      Mutliplicity    4      3     4
                                                     _________________

                                      1 spr4          MgAl3  Mg    SiAl3
                            Species:  2 fspr          FeAl3  Fe    SiAl3
                                      3 spr5          Al     Mg    Al
                                      4 fsp5_i        Al     Fe    Al      


                                      Dependent endmember:

                                      fsp5_i = spr5 +  3/4 * (fspr - spr4) 


Sapp(KWP)

7                                     model type 
2                                     reciprocal solution
2 2                                   2 species on each site
spr4     fspr        
spr5     fsp5_i

1                                     1 dependent endmember 
fsp5_i = 1 spr5 +  3/4 fspr - 3/4 spr4

0  0  0  0                | endmember flags

0. 1. 0.1  0              | range and resolution for X(Mg), imod = 0 -> cartesian subdivision
0. 1. 0.1  0              | range and resolution for 1-X(Tschermaks), imod = 0 -> cartesian subdivision

begin_excess_function 
w(spr5 spr4) 10000 0 0
w(spr5 fspr) 12000 0 0
w(spr4 fspr)  8000 0 0
end_excess_function 

3                          | 3 site (MA, MB, T) configurational entropy model

2 3.                       | 2 species on MB, 3 sites per formula unit
z(mb,mg) = 1 spr5 + 1 spr4

3 4.                       | 3 species on MA, 4 sites per formula unit.
z(ma,Al) = 1 spr5 + 1/4 fspr
z(ma,fe) = 1/4 fspr

2 4.                       | 2 species on T, 4 sites per formula unit.
z(T,si) = 1/4 spr4 + 1/4 fspr        

end_of_model               
                      --------------------------------------------------------
begin_model               
                            Osumilite, ideal, Holland et al Contrib Mineral Petrol (1996) 124: 383-394
              
                                                      1      2     3           
                                                      M1     T1    T2   
                                                     _________________

                                      Mutliplicity    2      3     2
                                                     _________________
              
                            Species:            osm1  Mg    Al     Al   
                                                osm2  Mg    MgAl2  AlSi 
                                                fosm  Fe    Al     Al       

Osm(HP)

2                                     model type: Margules, endmember fractions. 
3                                     number of endmembers 
osm1     osm2      fosm               endmember names 
0  0  0                               endmember flags
0. 1.   0.1  0   | imod = 0 -> cartesian subdivision
0. 1.   0.1  0   | imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, T1, T2) configurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit
z(m1,fe) = 1 fosm

2 3.                       | 2 species on T1, 3 sites per formula unit.
z(t1,mg) = 1/3 osm2

2 2.                       | 2 species on T2, 2 sites per formula unit.
z(t2,si) = 1/2 osm2


end_of_model              
                      --------------------------------------------------------
begin_model                
                                      primitive non-inverse spinel model
                                      with gahnite end-member. Interaction
                                      parameters after Nichols et al.(1992), CMP
                                      111, 362-377. Jiri Konopasek
GaHcSp
2                                     model type margules, macroscopic
3                                     3 endmembers
gah      herc     sp                  endmember names - this order implies: x(1) = x(Zn),x(2) = x(Fe), x(3) = x(Mg)

0  0  0                               endmember flags

0.0 0.2 0.1 1            | range and resolution for X(Zn), imod = 1 -> asymmetric transform subdivision
0.0 1.  0.1 0            | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(gah herc) -3800. 0. 0.   
w(herc sp)   1960. 0. 0.
w(gah sp)   -2600. 0. 0.   
end_excess_function 

1                                     one site configurational entropy model

3 1.                                  3 species on M site with multiplicity 1
                                      
z(M,mg) = 1 sp
z(M,fe) = 1 herc

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                             Scapolite Mizzonite-Meionite model for Rainer 
                             Abart's ETH Dissertation, see thesis for sources.

Scp   
1                            model type margules.                     
1 
2 1                          isp(1), ist(1) 
miz      me 
0 0                          endmember flags 
0.0 1.0 0.1 0               subdivision ranges and model 
0 0                          iterm, iord 
2 2                          sites (A, T) 
2 4.                         2 species on A site, multiplicity = 4 
1 0.                         z(A,Na) = x(11) / 4 
1                            1st order term 
0.25 1 1 
2 12.                        2 species on T, mutiplicity = 12 
1 0.5                        z(T,Al) = 1/2 - x(11)/12 
1                            1st order term 
-0.08333333333 1 1 

end_of_model             
                    --------------------------------------------------------  
begin_model                
                         
F                                 | Fluid, ala Connolly and Trommsdorff CMP 1991.
0                                 | model type internal EoS.
2                                 | 2 endmembers
CO2      H2O     
  0  0                            | endmember flags                                

0.0 1.0 0.1 0                     | subdivision ranges, 0 => cartesian subdivision  
ideal
0                                 | no config entropy (internal model)

end_of_model               
                    --------------------------------------------------------  
begin_model                                                                                   

F(salt)                    | H2O-CO2-NaCl Fluid from andreas's thesis
26                         | model type internal EoS.
3                          | three endmembers  
hltL                                   
H2O  
CO2  
0  0  0                    
0.0 1.0 0.1 0              | range and increment for x(hlt), imod = 0 -> cartesian subdivision
0.0 1.0 0.1 0              | range and increment for x(H2O), imod = 0 -> cartesian subdivision

ideal                      | internal excess function
0                          | internal config entropy model

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Talc as an ideal H&P solution.

                                                      1       2           
                                                      M1      M2       T2   
                                                     ______________________

                                      Mutliplicity    2       1         2
                                                     ______________________

                                      1 en            Mg      Mg       SiSi
                            Species:  2 fs            Fe      Fe       SiSi
                                      3 mgts          Mg      Al       AlSi
                                      4 fets          Fe      Al       AlSi dependent
                                                      ______________________


                           Dependent: ftat = tats + 2/3*(ta - fta)


T                          | solution name 

7                          | model type: reciprocal, macroscopic

2                          | 2 site reciprocal solution

2  2                       | 2 species on each site

ta       fta               | endmember names, this order implies: 
tats     ftat_i            | x(11)=x(mg); x(12) = x(fe); x(21) = x(SiAl,t2); x(22) = x(Al2,t2) 

1                          | 1 dependent endmember:

ftat_i = 1 tats + 2/3 fta - 2/3 ta

0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.
0.0 1. 0.1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision
0.0 1. 0.1  0              | range and resolution for 1-X(Tschermaks) on site 2, imod = 0 -> cartesian subdivision

ideal

3                          | 3 site (M1, M2, T2) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 ta + 1 tats                 
                
2 2.                       | 2 species on T2, 2 sites per formula unit.

z(t2,al) = 1/2 tats 

3 1.                       | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 ta 
z(fe,m2) = 1 fta

end_of_model               

                      --------------------------------------------------------
begin_model                
                             Scapolite as an ideal H&P solution.
                             Presumably from Barbara Kuhn's thesis.

                                                                        
                                                      M       T2a       T2b   
                                                     ______________________

                                      Mutliplicity    4       1         2
                                                     ______________________

                                      1 me            Ca      Al       Al     independent
                            Species:  2 coma          Na3Ca   Si       Si     independent 
                                      _____________________________________

                                      3 mizz          NaCa3   Si       Al     ordered



Scap                       | solution name 

6                          | model type: compound formation



2                          | 2 endmembers
me
coma 

1                          | ordered species definition

mizz = 2/3 me + 1/3 coma   enthalpy_of_formation = -13.67d3 

0 0                        | endmember flags
0.0 1. 0.1  0              

begin_excess_function 
w(me coma)   20000. 0. 0.   
w(me mizz)   20000. 0. 0.
w(coma mizz) 30000. 0. 0.   
end_excess_function 
3                          | 3 site (M1, T2a, T2b) conigurational entropy model

2 4.                       | 2 species on M, 4 sites per formula unit.

z(m,na) = 1/4 mizz  +  3/4 coma               
                
2 1.                       | 2 species on T2a, 1 site per formula unit.

z(t2a,al) = 1 me 

2 2.                       | 2 species on T2b, 1 site per formula unit.

z(t1a,si) = 1 coma

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      
St(HP)                     | Mn-Fe-Mg Staurolite 
                                                            
2                                     model type: Ideal or Margules
3                                     3 endmembers 
mnst     fst      mst     
  1  0  0                  | endmember flags

              
0. 1. 0.1 1                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1 0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(mst fst) -8d3 0. 0. 
end_excess_function 

1                                     1 site entropy model

3 4.                                  3 species, site multiplicity of 4
z(Fe) = 1 fst
z(Mg) = 1 mst

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                             Mn-Fe-Mg Ctd

Ctd(HP)                                                                                
2                          | model type: Ideal or Margules
3                          | 3 endmembers 
mnctd    fctd     mctd                 
  1  0  0                  | endmember flags

                           | Note restricted range on X(Mn)
              
0. .2 0.1 1                | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1 0                | range and resolution for X(Fe), imod = 0 -> cartesian subdivision

begin_excess_function 
w(mctd fctd) 1000. 0. 0. 
end_excess_function 

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity = 1.
z(Fe) = 1 fctd
z(Mg) = 1 mctd

end_of_model               
                      --------------------------------------------------------
begin_model                

Carp                       | Carpholite 
2                          | model type: Margules.
2                          | 2 endmembers 
mcar     fcar    
  0  0                     | endmember flags

0.     1.      0.1     0   | imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(Mg) = 1 mcar

end_of_model               
                      --------------------------------------------------------
begin_model               
                             ideal anhydrous/hydrous mg/fe HP cordierite model.
                             hfcrd_i stoichiometry corrected, L. Baumgartner, 5/6/03
   
                                                      M       H
                                                     ________________          

                                      Mutliplicity    2       1          
                                                     ________________         

                                      1 mncrd         Mn      Vac           
                            Species:  2 fcrd          Fe      Vac  
                                      3 crd           Mg      Vac         
                                      4 hmncrd        Mn      H2O    dependent       
                                      5 hfcrd         Fe      H2O    dependent
                                      6 hcrd          Mg      H2O         
                                                      _______________        

                            Dependent: hfcrd = hcrd + (fcrd - crd)
                           
hCrd 
7                                 model type: reciprocal                                     
2                                 2 reciprocal sites
3  2                              3 species on site 1, 2 on site 2 
mncrd    fcrd     crd 
hmncrd_i hfcrd_i  hcrd

2                                 2 dependent endmembers 

hfcrd_i = 1 hcrd +  1 fcrd - 1 crd
hmncrd_i = 1 hcrd + 1 mncrd - 1 crd

1 0 0 1 0 0                | endmember flags

                           | Note restricted range on X(Mn)
 
0. .2 .1  1                | range and resolution for X(Mn) on M site, imod = 1 -> asymmetric transform subdivision
0. 1. .1  0                | range and resolution for X(Fe) on M site, imod = 0 -> cartesian subdivision

0. 1.  .1 0                | range and resolution for 1-X(H2O) on H site, imod = 0 -> cartesian subdivision  

ideal 

2                                       2 site entropy model.

3 2.                                    3 species on M, 2 sites per formula unit.
z(m,mg) = 1 crd + 1 hcrd
z(m,fe) = 1 fcrd 

2 1.                                    2 species on H, 1 sites per formula unit.
z(H,H2O) = 1 hcrd 

end_of_model              
                      --------------------------------------------------------
begin_model               
                           | ideal model for pumpellyite (considering only
                           | the endmembers mg-pmp, fe-pmp, julg.
                           | Claudio.Mazzoli@bristol.ac.uk /JADC
Pmp                        
1                          | model type: Margules
1
3 1                        | x(11)=x(mg,al5) x(12)=x(fe,al5) x(13)=x(fe,fe5).
mpmp     fpmp     julg     | endmember names 

0 0 0                      | endmember flags

0. 1. 0.2 0 
0. 1. 0.2 0                | pseudocompound model cartesian

0 0                        | iterm, iord.
2                          | msite, 2 sites, X, X1+Y.

2 1.                       | 2 species on X, 1 site per formula unit.

1 0.                       | z(11) = z(mg,X) = x(11)
1                         
1. 1 1

2 5.                       | 2 species on X1+Y, 5 sites per formula unit.

1 0.                       | z(21) = z(fe,X1+Y) = x(13). 
1                         
1. 1 3

end_of_model              
                      --------------------------------------------------------
begin_model                
                           | ideal model for mg-al tshermaks in clintonite assuming
                           | endmembers:
                           | ct1 = Ca(Mg,m2)(AlMg,M1)2 (Al,T2)2 (AlSi,T1)2
                           | ct2 = Ca(Mg,m2)(MgMg,M1)2 (Al,T2)2 (SiSi,T1)2
Clint
1                          | model type: Margules
1
  2  2                     | isp(1), ist(1)
ct1      ct2
  0  0                     | endmember flags
0. 1. 0.1  0             | cartesian subdivision
0 0                        | iterm, iord.
2                          | 2 independent mixing sites M1 and T1

2 2.                       | 2 species on M1, 2 sites per formula unit.
1 0.5                      | z(11) = z(al,m1) = 1/2 - x(12)/2 
1                         
-0.5  1 2

2 2.                       | 2 species on T1, 2 sites per formula unit.
1 0.5                      | z(11) = z(al,t1) = 1/2 - x(12)/2 
1                         
-0.5  1 2

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                           | ideal model for mg-fe sudoite assuming
                           | mg fe and al are distributed over 
                           | 4 m1 sites. 
Sud(Livi)
2                          | Macroscopic

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1. 0.1  0               | imod = 0 -> cartesian subdivision

ideal

1                          | 1 independent mixing site, M1.

3 4.                       | 3 species on M1, 4 sites per formula unit.

z(Mg) = 1/2 sud
z(Fe) = 1/2 fsud

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | ideal model for mg-fe sudoite assuming
                           | mg and fe are distributed over 
                           | 2 sites. 

Sud
2                          | model type: Margules

2                          | 2 endmembers
fsud     sud
  0  0                     | endmember flags
0. 1. 0.1  0               | imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(Mg) = 1 sud

end_of_model         
                      --------------------------------------------------------
begin_model                
                              HP '98 Non-ideal amphibole

Cumm                                                                              
2                           | model type: macroscopic
2                                    
cumm     grun   
  0  0                      
0. 1. 0.1 0                 | imod = 0 -> cartesian subdivision

begin_excess_function 
W(cumm grun)  17500. 0. 0.  
end_excess_function

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 cumm

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      anthophyllite

Anth                                                                              
2                                   | model type: macroscopic
2                                     isp
fanth    anth     
  0  0                                endmember flags
0. 1. 0.1      0        subdivision ranges and model

ideal 

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 anth

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      "anthophyllite" a compromise
                                      model using the clinoamphibole
                                      Fe-endmember, cumm and fap should
                                      be excluded.
A
2                          | model type: Macroscopic
2                             
grun     ap      
  0  0                               
0. 1. 0.1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 7.                                  2 species, site multiplicity = 7.
z(mg) = 1 ap

end_of_model               
                      --------------------------------------------------------
begin_model                

Gl                                                                                
2                          | model type: Macroscopic
2                              
gl       fgl     
  0  0                                endmember flags
0. 1. 0.1      0           | subdivision ranges and model, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 3.                                  2 species, site multiplicity = 3
z(gl) = 1 gl

end_of_model              
                      --------------------------------------------------------
begin_model                

Tr                         | Tremolite                                                      
2                          | model type: Macroscopic
2                           
ftr      tr      
  0  0                                endmember flags

0. 1. 0.1      0           | subdivision ranges, imod = 0 -> cartesian subdivision

ideal 

1                                     1 site entropy model

2 5.                                  2 species, site multiplicity = 5.
z(mg) = 1 tr
                           
end_of_model                    
                      --------------------------------------------------------
begin_model                
                                      See notes for TrTsPg (above).
 
                                      JADC 4/03. 

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)         


GlTrTsPg                   | solution name 
7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quaternary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  

3                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr

0 0 0 0 1 0 0 0           | endmember flags.

0. 1.0 0.1 0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1 0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1 0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1 0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
                            | interaction parameters from
                            | White, Powell & Phillips (2003, JMG)
                            | and Wei, Powell, & Zhang (2003, JMG) 
                            | compiled by D. Tinkham. JADC 11/03 
W(parg gl)  80d3 0. 0. 
W(parg tr)  30d3 0. 0. 
W(parg ftr) 38d3 0. 0.  
W(gl tr)    77d3 0. 0. 
W(gl ftr)   83d3 0. 0. 
W(ts tr)    20d3 0. 0. 
W(ts ftr)  -38d3 0. 0. 
W(tr ftr)   10d3 0. 0.
                            | earlier versions used (provenance unknown)

                            | W(ts parg) -25000. 0. 0. 
                            | W(tr parg)  20000. 0. 0. 
                            | W(tr ts)    38000. 0. 0.  
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropu model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl

3 2.                       | 3 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg 
z(m2,fe) = 1 ftr 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

end_of_model             
                      --------------------------------------------------------
begin_model               
                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si
                             


                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without K, Ti or Mn solution.
 
                                      JADC 9/05. 

                             fparg = parg + 4/5 (ftr  - tr)
                             fgl   = gl   + 3/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)         


Amph(DHP)                  | solution name 
7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  
mfets    ffets_i

4                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0. 1.0 0.1  0              | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1  0              | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1  0              | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1  0              | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0. 1.  0.1  0              | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(parg gl)  84.5d3 0. 0. 
W(parg tr)  29.3d3 0. 0.
W(parg ts)  18.2d3 0. 0. 
W(parg ftr) 11.4d3 0. 0.  
W(gl tr)    35.3d3 0. 0.  
W(ts tr)    20.8d3 0. 0. 
W(tr ftr)   11.4d3 0. 0.
W(gl ftr)   15d3 0. 0. 
W(gl ts)    15d3 0. 0.
end_excess_function

5                          | 5 site (A, M1, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets  

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg 
z(m2,fe)   = 1 ftr 
z(m2,fe3+) = 1 mfets 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Dale et al, JMG 2005 23:771-791 amphibole model.

                             JADC, 11/05.

                             Margules parameters corrected from  
                                      W(gl ftr)     393d3  0. 0.
                                      W(gl mfets)   459d3  0. 0.
                                      W(ftr mfets)  125d3  0. 0.
                             to current values. 

                             M. Racek, 2/10/06.

                                             A         M13     M2     M4      T1*
                                            _________________________________________

                             Mutliplicity    1         3       2      2       4(1)
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts_d         Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg_d       Na        Fe      Fe_Al  Ca      Al_Si
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl_d         Vac       Fe      Al     Na      Si_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets_d       Vac       Fe      Fe3+   Ca      Al_Si

                             fparg_d = 1 parg + 4/5 ftr  - 4/5 tr 
                             fts_d   = 1 ts   + 3/5 ftr  - 3/5 tr 
                             fgl_d   = 1 gl   + 3/5 ftr  - 3/5 tr
                             ffets_d = 1 mfets + 3/5 ftr  - 3/5 tr        

                           *Dale et al compute amphibole T1 site fractions assuming 
                            a site multiplicity of 4, but compute activities for a
                            T1 site multiplicity of 1. In previous models H&P computed
                            activities for a T1 site multiplicity of 2.


Amph(DPW)                  | solution name 
7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 5                        | 1 binary and 1 quinary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
gl       fgl_i  
mfets    ffets_i

4                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
fgl_i   = 1 gl   + 3/5 ftr  - 3/5 tr
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 1 0 0 0 0 0        | endmember flags.

0. 1.0 0.1 0               | range and resolution for X(Mg) on site 1, imod = 0 -> cartesian subdivision

0. 1.0 0.1 0               | range and resolution for X(tr) on site 2, imod = 0 -> cartesian subdivision
0. 1.0 0.1 0               | range and resolution for X(pg) on site 2, imod = 0 -> cartesian subdivision 
0. 1.  0.1 0               | range and resolution for X(ts) on site 2, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | range and resolution for X(gl) on site 2, imod = 0 -> cartesian subdivision

begin_excess_function
W(tr ts)      20d3   0. 0. 
W(tr parg)    33d3   0. 0.
W(tr gl)      65d3   0. 0. 
W(tr ftr)     10d3   0. 0.  
W(tr mfets)   20d3   0. 0.  
W(ts parg)   -385d2  0. 0. 
W(ts gl)      25d3   0. 0.
W(ts ftr)     125d2  0. 0. 
W(parg gl)    50d3   0. 0.
W(parg ftr)  -19d2   0. 0.
W(parg mfets) -385d2  0. 0.
W(gl ftr)     393d2  0. 0.
W(gl mfets)   459d2  0. 0.
W(ftr mfets)  125d2  0. 0.
end_excess_function

5                          | 5 site (A, M13, M2, M4, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg 
              
2 1.                       | 2 species on T1, fake site multiplicity of 1.
z(T1,Al) = 1/2 ts + 1/2 parg + 1/2 mfets 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 gl + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg)   = 1 tr + 1/2 parg 
z(m2,fe)   = 1 ftr 
z(m2,fe3+) = 1 mfets 

2 2.                       | 2 species on M4, 2 sites pfu
z(m4,na) = 1 gl 


begin_van_laar_sizes                        
alpha(tr)     1.0    0.    0.                      
alpha(ts)     1.5    0.    0.                      
alpha(parg)   1.7    0.    0.
alpha(gl)     0.8    0.    0.
alpha(ftr)    1.0    0.    0.
alpha(mfets)  1.5    0.    0.
end_van_laar_sizes

begin_dqf_corrections
dqf(gl)   5d3 0 0 
dqf(ts)   1d4 0 0 
dqf(parg) 15d3 0 0 
end_dqf_corrections

end_of_model              
                      --------------------------------------------------------
begin_model                
                           | ternary feldsar (furman & lindsley 1988)
                           | for binary plagioclse this model is identical
                           | to that of Newton et al. 1980, and for binary
                           | alkali feldspar it is identical to Haselton et al. (1983).

                             CORRECTED FOR TYPO IN ORIGINAL PAPER.

feldspar                   
2                          | model type: Margules or Ideal
3                          | 3 endmembers
abh      
an       
san      
0 0 0                      | endmember flags = 0 if the endmember is part of the solution.
0. 1. 0.1   0              | range and resolution for albite, imod = 0 -> cartesian subdivision
0. 1. 0.1   0              | range and resolution for anorthite, imod = 0 -> cartesian subdivision

begin_excess_function 
w(abh abh san) 27320.   -10.3  .394 
w(abh san san) 18810.   -10.3  .394 
w(an  an  san) 52468.      .0   .0   
w(an  san san) 47396.      .0  -.12  
w(an  an  abh) 28226.      .0   .0   
w(an  abh abh) 8471.       .0   .0   
w(an  abh san) 100045.5 -10.3 -0.76 
end_excess_function 

2                          | 2 site (O-site and T-site) entropy model

3 1.                       | 3 species on O-site, 1 site per formula unit.
z(Na) = 1 abh
z(Ca) = 1 an

2 2.                       | 2 species on T-site, 2. sites per formula (al-avoidance model)
z(Al) = 1/2 + 1/2 an

end_of_model               
                      --------------------------------------------------------
begin_model               

Pl(h)                      | Newton et al 1981 
2                          | model type: Margules or Ideal                                     
2                          | 2 endmembers  
abh      an      
  1  0                     | endmember flags
0. 1. .1  0                | imod = 0 -> cartesian subdivision
begin_excess_function 
w(abh abh an) 8477.00 0. 0. 
w(an an abh) 28246.0 0. 0. 
end_excess_function 

2                          | 2 sites (O, T) kerrick and darkens Al-avoidance model:
2 1.                       | 2 species on O site, multiplicity = 1.
z(Na) = 1 abh

2 2.                       | 2 species on T, mutiplicity = 2.
z(Al) = 1/2 + 1/2 an

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | Waldbaum and Thompson 1968. This model is just the San 
                           | model with the low structural state endmembers.
Kf                         
2                          | model type: Macroscopic 
2                          | 2 endmembers

mic      ab     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(mic ab ab)  32098.0     -16.1356     0.469020
w(mic mic ab)  26470.0     -19.3810     0.387020 
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 ab

end_of_model              
                      --------------------------------------------------------
begin_model                

San                        | Waldbaum and Thompson 1968.
2                          | model type: Macroscopic 
2                          | 2 endmembers
san      abh     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(san abh abh)  32098.0     -16.1356     0.469020
w(san san abh)  26470.0     -19.3810     0.387020 
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

end_of_model    
                      --------------------------------------------------------
begin_model                

San(TH)                    | Thompson and Hovis 1979.
2                          | model type: Macroscopic 
2                          | 2 endmembers
san      abh     

  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(san abh abh)  17062.4       0.         0.360661
w(san san abh)  30978.3     -21.7568     0.360661
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 abh

end_of_model             
                      --------------------------------------------------------
begin_model                
                                      Connolly and Cesare C-O-H Fluid
                                      this model is for X(O) = 0-1

GCOHF   
0                          | model type: Internal EoS
2                                  
O2       H2     
  0  0                                endmember flags
0.0 1.0 0.1       0        | subdivision ranges, imod = 0 -> cartesian subdivision
   | 0.666666666             | second symmetry axis, required for imod = 3

ideal
0

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Non-ideal margarite-paragonite
                                      to fit field data of Bucher-Nurminen et al (1983)
                                      and Frank (1983), critical T = 972 K, X(Ma) = 33%.
                                      JADC, 4/08.
                                      


MaPa                       | margarite-paragonite                                          
2                          | macroscopic
2
pa       ma      
  0  0                                endmember flags
0. 1. 0.1 0                           subdivision ranges and model

begin_excess_function 
w(pa pa ma) 18201. 0. 0.
w(ma ma pa) 9101.  0. 0.
end_excess_function

  1                        | 1 site mixing model
2 1.                       | 2 species on O-site, 1 site per formula unit.
z(Na) = 1 pa

end_of_model              
                      --------------------------------------------------------
begin_model                
                           | non-ideal hybrid model for K-Na phengitic mica
                           | mixes Chaterjee and Froese (1975) with ideal phengite model

                           | this configurational entropy is that of HP '98, see Phen(HP)

                             config entropy corrected, D Tinkham, 5/6/03
   
                                                      A        M2a      T 
                                                     _________________________

                                      Mutliplicity    1         1       2 
                                                     _________________________

                            Species:  1 cel           K        Mg     Si_Si
                                      2 fcel          K        Fe     Si_Si 
                                      3 mu            K        Al     Al_Si     
                                      4 ncel          Na       Mg     Si_Si
                                      5 nfcel         Na       Fe     Si_Si
                                      6 pa            Na       Al     Al_Si     


KN-Phen                    | solution name 
7                          | model type: Margules, reciprocal
2                          | 2 site model
3 2                        | 3 species mix on M site, 2 species on A site

cel      fcel     mu       | endmember names 
ncel_i   nfcel_i  pa       | endmember names

2                          | 2 dependent endmembers

ncel_i = 1 cel + 1 pa - 1 mu
nfcel_i = 1 fcel + 1 pa - 1 mu


0 0 0 0 0 0                | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

0. 1. 0.1 0                | k-na subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
W(mu pa pa) 19456.0      1.65440     -.456100 
W(mu mu pa) 12230.0     0.710440     0.665300     
end_excess_function

3                          | 3 site (M2a, T2, A) entropy model

3 1.                       | 3 species on M2a, 1 sites per formula unit.
z(m,mg) = 1 cel 
z(m,fe) = 1 fcel 

2 2.                       | 2 species on T2, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa

2 1.                       | 2 species on A, 1 site per formula unit.
z(a,k) = 1 mu + 1 cel + 1 fcel

end_of_model               
                      --------------------------------------------------------
begin_model                

MuPa                                chatterjee & froese '75                                           
2                                 | model type: Ideal or Margules
2                               
mu       pa      
  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
W(mu pa pa) 19456.0      1.65440     -.456100 
W(mu mu pa) 12230.0     0.710440     0.665300     
end_excess_function

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(K) = 1 mu

end_of_model          
                      --------------------------------------------------------
begin_model                
                             Mica(CHA1): Reciprocal version of white mica model Mica(CHA) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             Coggon & Holland model orginally entered by Mark Caddick, Aug 30, 2005.

                             This model allows Tschermaks and Ti substitution in both the Na
                             and Ca mica subsytems. When these substitutions are insignificant, 
                             use of the reduced version of the model used in Mica(CHA)  
                             is much more efficient.

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip). 

                             MODIFICATION/CORRECTION HISTORY:

                             1) van laar size terms added Nov 25, 2005. JADC.

                             2) ma t12 site occupancy corrected from AlSi to AlAl, D. Dolejs. Mar 23, 2006

                             3) endmember order corrected from: mu pa ma cel npa nfpa fcel nfma nma
                                                            to: mu pa ma cel npa nma  fcel nfpa nfma
                                                            JADC, May 4, 2006.

                             4) van Laar size terms for potassic endmembers corrected from 0.67 to 0.63. 
                                                             L. Tajcmanova, Jan 6, 2010.

                             5) extended from Mica(CH1) to include Ti-substitution afer Auzanneau et al (2010).
                                               

                                                      A       M2a    M2b    T12    M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma            Ca      Al      Al    AlAl    _

                                      4 cel           K       Mg      Al    SiSi    _ 
                                      5 npa           Na      Mg      Al    SiSi    _    dependent
                                      6 nma           Ca      Mg      Al    AlSi    _    dependent
                                    
                                      7 fcel          K       Fe      Al    SiSi    _
                                      8 nfpa          Na      Fe      Al    SiSi    _    dependent
                                      9 nfma          Ca      Fe      Al    SiSi    _    dependent

                                     10 tip           K       Mg      Ti    AlSi    _
                                     11 ntip          Na      Mg      Ti    AlSi    _    dependent
                                     12 ctip          Ca      Mg      Ti    AlAl    _    dependent

                                     13 ftip          K       Fe      Ti    AlSi    _    dependent
                                     14 nftip         Na      Fe      Ti    AlSi    _    dependent
                                     15 cftip         Ca      Fe      Ti    AlAl    _    dependent
                                                     ___________________________________



Mica(CHA1)                    

7                            | model type: Macroscopic Margules with dependent endmembers.
2                            | number of independent mixing sites
3  5                         | 3 species on site 1, 5 species on site 2.


cel npa nma 
fcel nfpa nfma
tip ntip ctip
ftip nftip cftip
mu pa ma 

9                            | dependent end-members

nma   = 1 cel + 1 ma - 1 mu
npa   = 1 cel + 1 pa - 1 mu
nfpa  = 1 fcel + 1 pa - 1 mu
nfma  = 1 fcel + 1 ma - 1 mu
ntip  = 1 tip + 1 pa - 1 mu
ctip  = 1 tip + 1 ma - 1 mu
ftip  = 1 tip + 1 fcel - 1 cel
nftip = 1 tip + 1 fcel - 1 cel + 1 pa - 1 mu
cftip = 1 tip + 1 fcel - 1 cel + 1 ma - 1 mu


0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0                | endmember flags
                   
                             | subdivision model, site 1 (A):
0. 1.   .1  0                | range and resolution of X(K)
0. 1.   .1  0                | range and resolution of X(Na)

                             | subdivision model, site 2 (M2)
0. .8   .1   0               | range and resolution of X(MgAl,M2)
0. .5   .1   0               | range and resolution of X(FeAl,M2)
0. .5   .1   1               | range and resolution of X(MgTi,M2)
0. .3   .1   1               | range and resolution of X(FeTi,M2)

begin_excess_function

W(mu pa)    10120. 3.4 0.353  
W(mu ma)    30000. 0. 0. 
W(mu cel)   0. 0. 0.2
W(mu fcel)  0. 0. 0.2
W(pa ma)    14500. 0. 0. 
W(pa cel)   52000. 0. 0. 
W(pa fcel)  52000. 0. 0. 
W(ma cel)   30000. 0. 0.2
W(ma fcel)  30000. 0. 0.2
W(tip cel)  10000. 0. 0.
W(tip fcel) 10000. 0. 0.
W(tip pa)   80000. 0. 0.

 | W(prl mu)   20000. 0. 0.2
 | W(prl pa)   20000. 0. 0.2
 | W(prl ma)   30000. 0. 0.2
 | W(prl cel)  25000. 0. 0.2
 | W(prl fcel) 25000. 0. 0.2
 | W(prl tip)  40000. 0. 0.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel   
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma 
z(m2a,mg) = 1 cel + 1 tip

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma)     0.37 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(tip)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.
 | alpha(prl)    0.5  0. 0.
 | alpha(phl)    0.63 0. 0.
end_van_laar_sizes

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                
                             Mica(CHA): Non-reciprocal version of white mica model Mica(CHA1) after:

                                Coggon & Holland (JMG, 2002, 20:683-696)
                                Auzanneau et al. (CMP 159:1-24, 2010)

                             The non-reciprocal version does not allow tschermaks or Ti substutions
                             in the Ca- and Na-subsystems. If these substitutions are important use 
                             the more costly model Mica(CHA1)

                             This model requires the make definition:

                                tip = 1 fcel + 1 geik - 1/2 fs
                                -482876.  -14.694 .84

                             in the thermodynamic data file (e.g., hp02ver.dat) for Ti-phengite (tip).

                             This version does not include the prl and phl endmembers considered by
                             both Coggon & Holland (2002) and Auzanneau et al. (2010) (the data is commented
                             below) as solution of these endmembers is usually unimportant.

                             JADC, 1/18/10



                                                           
                                                      A       M2a    M2b    T1     M1
                                                     ___________________________________

                                      Mutliplicity    1       1       1      2      1
                                                     ___________________________________

                                      1 mu            K       Al      Al    AlSi    _
                                      2 pa            Na      Al      Al    AlSi    _      
                                      3 ma            Ca      Al      Al    AlAl    _
                                      4 cel           K       Mg      Al    SiSi    _                                      
                                      5 fcel          K       Fe      Al    SiSi    _
                                      6 tip           K       Mg      Ti    AlSi    _

                             not included:
                                                     ___________________________________
                                      7 prl           _       Al      Al    SiSi    _
                                      8 phl           K       Mg      Mg    AlSi    Mg
                                                     ___________________________________


Mica(CHA)                    
2                            | model type: macroscopic.

6                            | 6 endmembers

mu pa ma cel tip fcel        | prl phl

0 0 0 0 0 0 0 0              | endmember flags
                   
                             | subdivision model
0. 1.   .1 0                 | range and resolution of X(mu),  imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(pa),  imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(ma),  imod = 0 -> cartesian subdivision
0. 1.   .1 0                 | range and resolution of X(cel), imod = 0 -> cartesian subdivision
0. 0.3  .1 1                 | range and resolution of X(tip), imod = 1 -> asymmetric transform subdivision

begin_excess_function

W(mu pa)    10120. 3.4 0.353  
W(mu ma)    30000. 0. 0. 
W(mu cel)   0. 0. 0.2
W(mu fcel)  0. 0. 0.2
W(pa ma)    14500. 0. 0. 
W(pa cel)   52000. 0. 0. 
W(pa fcel)  52000. 0. 0. 
W(ma cel)   30000. 0. 0.2
W(ma fcel)  30000. 0. 0.2
W(tip cel)  10000. 0. 0.
W(tip fcel) 10000. 0. 0.
W(tip pa)   80000. 0. 0.

 | W(prl mu)   20000. 0. 0.2
 | W(prl pa)   20000. 0. 0.2
 | W(prl ma)   30000. 0. 0.2
 | W(prl cel)  25000. 0. 0.2
 | W(prl fcel) 25000. 0. 0.2
 | W(prl tip)  40000. 0. 0.

end_excess function

4                           | Configurational entropy: 4 sites, A, M2a, M2b, T1.

3 1.                        | 3 species on A, 1 site per formula unit.

z(a,k) = 1 mu  + 1 cel + 1 fcel   
z(a,na) = 1 pa 

3 1.                        | 3 species on M2a, 1 site per formula unit.

z(m2a,al) = 1 mu + 1 pa + 1 ma 
z(m2a,mg) = 1 cel + 1 tip

2 1.                        | 2 species on M2b, 1 site per formula unit.
z(m2b,ti) = 1 tip

2 2.                        | 2 species on T1, 2 sites per formula unit.
z(t,al) = 1/2 mu + 1/2 pa + 1/2 tip + 1 ma 

begin_van_laar_sizes                        
alpha(mu)     0.63 0. 0.                        
alpha(pa)     0.37 0. 0.                     
alpha(ma)     0.37 0. 0.    
alpha(cel)    0.63 0. 0.
alpha(tip)    0.63 0. 0.
alpha(fcel)   0.63 0. 0.
 | alpha(prl)    0.5  0. 0.
 | alpha(phl)    0.63 0. 0.
end_van_laar_sizes

end_of_model                  
                                  --------------------------------------------------------
begin_model                
                                      HP '98 olivine solution
O(HP)                                                                               
2                                     model type: Margules, macroscopic

3                                     3 endmembers
teph     fo       fa            
  0  0  0                           | endmember flags

                                    | NOTE restricted compositional range for Mn 

0.0 1.0  0.1   1                    | range and resolution for X(Mn), imod = 1 -> asymmetric transform subdivision
0.0 1.0  0.1   0                    | range and resolution for X(Mg), imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400. 0. 0.                | corrected from 4.2 kJ Nov 15, 2004.
end_excess_function 

1                                     1 site entropy model

3 2.                                  3 species, site multiplicity = 2.
z(mg) = 1 fo
z(fe) = 1 fa 

end_of_model              
                      --------------------------------------------------------
begin_model                
                                      "Ordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di. 
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit. 
                                      This should be Gaspariks preferred model. 
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and an
                                      X molecular model for Jd-Di. This implies that
                                      there is no disorder associated with placing Na
                                      on M2 (i.e., it is associated with Al on M1), 
                                      whereas Al on M1 is not assocated with Al on T.
                                      To get Gasparik's molecular formulation it is
                                      necessary to specify that Al mixes on only one
                                      of the two T-sites.


Cpx(l)                                                    
2                                  | model type: Ideal or Margules

4                                  | 4 endmembers

di
hed      
cats                  
jd  

0  0  0  0                         | endmember flags

0. 1. 0.1  0
0. 1. 0.1  0
0. 1. 0.1 0                        | subdivision ranges and model


begin_excess_function 
w(cats jd) 14810.      -7.15        0.          
w(cats cats jd) -5070.       0.00  0.            
w(cats jd jd)   5070.       0.00  0.           
w(cats cats cats jd)  -3350.       0.00  0.     
w(cats cats jd jd)   6700.       0.00  0.               
w(cats jd jd jd)   -3350.       0.00  0.              
w(di jd jd)    12600.  -7.6 0.                   
w(di di jd)   -12600.   7.6 0.           
w(di jd jd jd)  -21400.      16.2   0.    
w(di di jd jd)    42800.     -32.4   0.         
w(di di di jd)   21400.     -16.2   0.           
w(di jd)   12600.      -9.45  0.
         
w(di hed)    2500.       0.0   0.         
w(hed hed jd)    -12600.       7.6   0.           
w(hed jd jd jd)  -21400.      16.2   0. 
          
w(hed jd)   12600.      -9.45  0.         
w(hed jd jd)   12600.      -7.6   0.       
w(hed hed jd jd)   42800.     -32.4   0.      
w(hed hed hed jd) -21400.      16.2   0.
   
end_excess_function 

2                                     wierd entropy model, see above (maybe it's right).

3 1.                                  M1, Al-Mg-Fe, 1 site

z(fe,m1) = 1 hed 
z(mg,m1) = 1 di  

2 1.                                  T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model             
                      --------------------------------------------------------
begin_model                
                                      "disordered" Jadeite-Diopside-Hedenbergite-CaTs,
                                      as: 1) Gasparik '85 (GCA) in the jd/di limit.
                                          2) HP'98 in the di/hed limit
                                          3) Assuming nonideality in the
                                             jd/hed limit is the same as for jd/di. 
                                          4) No ternary interactions.
                                          5) Gasparik '85 (CMP) in the jd/cats limit. 
                                      JADC Apr. 99.

                                      the configurational entropy model has been
                                      constructed to take into account that Gasparik
                                      uses an X^2 molecular model for CaTs-Di and 
                                      Jd-Di. See comments for Cpx(l) above.

Cpx(h)               
                                     
2                                  
4                                  
di       
hed      
cats             
jd  

0  0  0  0                         | endmember flags

0. 1. 0.1  0 
0. 1. 0.1  0 
0. 1. 0.1  0                       | subdivision ranges and model


begin_excess_function 
w(cats jd) 14810.      -7.15        0.          
w(cats cats jd) -5070.       0.00  0.            
w(cats jd jd)   5070.       0.00  0.           
w(cats cats cats jd)  -3350.       0.00  0.     
w(cats cats jd jd)   6700.       0.00  0.               
w(cats jd jd jd)   -3350.       0.00  0.              
w(di jd jd)   12430.      -6.21  0.               
w(di di jd)  -12430.       6.21  0.         
w(di jd jd jd)  -22290.      23.19   0.  
w(di di jd jd)   44580.     -46.38   0.        
w(di di di jd)  -22290.      23.19   0.         
w(di jd)   12540.      12.63  0.         
w(di hed)    2500.       0.0   0.         
w(hed hed jd)  -12430.       6.21  0.       
w(hed jd jd jd) -22290.      23.19   0.            
w(hed jd)  12540.      12.63  0.           
w(hed jd jd)  12430.      -6.21  0.     
w(hed hed jd jd)  44580.     -46.38   0.     
w(hed hed hed jd) -22290.      23.19   0.     
end_excess_function 

3                                     msite
3 1.                                  M1, Al-Mg-Fe, 1 site

z(Fe,m1) = 1 hed
z(Mg,m1) = 1 di 

2 1.                                  M2, Ca-Na, 1 site

z(na,m2) = 1 jd

2 1.                                  T, Al-Si, this is fake to get gasparik's model.
z(al,t) = 1 cats

end_of_model               
                      --------------------------------------------------------
begin_model                
                                   
Mont                                                                               
2                          | macroscopic

3                          | 3 endmembers
fo       mont 
fa    
0  0  0                               

0.0    1.0    0.1     0    | subdivision range, imod = 0 -> cartesian subdivision
0.0    1.0    0.1     0    | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 8400. 0. 0.                | corrected from 4.2 kJ Nov 15, 2004.
end_excess_function 

1
3 1.
z(Ca) = 1/2 mont
z(Mg) = 1 fo + 1/2 mont


end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                                      HP '98 dolomite-ankerite solution

Do(HP)                                                                               
2                          | macroscopic

2                          | 2 endmembers                     
dol      ank     
  0  0                     | endmember flags

0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(dol ank) 3000.0 0. 0. 0. 0.
end_excess_function 

1                          | 1 site entropy model
2 1. 
z(Mg) = 1 dol

end_of_model               
                     -------------------------------------------------------- 
begin_model               
                                      HP '98 Magnesite/siderite modified by DMH 
                                      to include rhc 
M(HP)                                                                           
2                                     model type: Margules, endmember fractions.                                                                               

3                                     number of endmembers 
rhc    mag     sid                    endmember names 

  0  0  0                        | endmember flags

0. 1. 0.1  1                       | range X(Mn), imod = 1 -> asymmetric transform subdivision
0. 1. 0.1  0                       | range X(Fe), imod = 0 -> cartesian subdivision               

begin_excess_function
w(mag sid) 4000. 0. 0.          | hp '98 give 4 kJ
end_excess_function  

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity 1
z(Fe) = 1 sid
z(Mg) = 1 mag

end_of_model               
                     -------------------------------------------------------- 
begin_model                
                   A solution model for Dolomite from Anovitz & Essene 
                   1987 J Pet 28:389-414; this model requires fictive
                   do-structure endmembers that have a standard state
                   G 20920 j > than the cc-structure endmember, these 
                   are made here by a "DQF" correction.

Do(AE)                            
2                          | model type: Ideal or Margules

3                          | 3 endmembers    
cc       
mag
sid 
1 1 1                      | endmember flags
0. 1. 0.1 0                | subdivision range X(cc), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range X(mag), imod = 0 -> cartesian subdivision
begin_excess_function 
w(mag mag cc) -96850   36.23  0
w(mag cc cc) -55480   -22.85  0  
w(sid sid cc) -155523  141.5  0  | this is a linearization of -1040 -T*(212.4  - 0.2027*T) at 873 K, JADC 5/08.
w(sid cc cc)  -16746   -89.2  0  | this is a linearization of -86740-T*(-71.18+.9184e-1*T) at 873 K, JADC 5/08.
w(sid cc mag) -293520 -121.6  0  | this is a linearization of -185450-T*(369.2-.1418*T) at 873 K, JADC 5/08. 
end_excess_function 
1                          | 1 site entropy model
3 1.                       | 2 species, site multiplicity of 1? should check against source
z(Mg) = 1 mag
z(Fe) = 1 sid

begin_dqf_corrections
dqf(cc) 20920 0 0 
dqf(mag) 20920 0 0 
dqf(sid) 20920 0 0 
end_dqf_corrections

end_of_model               
                      --------------------------------------------------------
begin_model              
                   A solution model for Magnesite from Anovitz & Essene 
                   1987 J Pet 28:389-414.
Cc(AE)          
                   
2                          | model type: Ideal or Margules

3                          | 2 endmembers  
mag      
cc
sid
0  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(cc cc mag)  24300 -7.743 0        
w(cc mag mag) 23240  0.    0  
w(sid sid cc) 28404 -2.5   0 | this is a linearization of 27313.2-5.9651e-6/T-1.43147e-3*T^2 at T = 873. JADC, 5/08.
w(sid cc cc)  20624 -7.533 0 | this is a linearization of -70751.4 + 91.8848*T + 2.79244e7/T - 3.59552e-2 * T^2 at T = 873. JADC, 5/08.
                             | missing the ternary interaction parameter estimated by Anovitz & Essene. 
end_excess_function

1
3 1.
z(mg) = 1 mag
z(fe) = 1 sid
end_of_model  
                      --------------------------------------------------------
begin_model               
                             Magnesioferrite/magnetite

MF                                                                               
2                          | model type: Ideal or Margules

2  1                                isp(1), ist(1) 
mt       mfer    
  0  0                                endmember flags
0.    1.  .1     0         subdivision range, imod = 0 -> cartesian subdivision

ideal

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 2
z(Fe) = 1 mt

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model


Sp(JR)                      Jamieson and Roeder '85 (iron + ol,1300 C)                          

2                          | model type: Ideal or Margules

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) -3102. 0. 0. 
end_excess_function

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ghiorso 1991, gives similar W=8638

Sp(GS)                                Ganguly and Saxena '87 (ol, 1200-1300 C, 1-5 kb)
2                          | model type: Ideal or Margules

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) 7703. 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity of 2
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

Sp(HP)                                 HP '98:
2                          | model type: Ideal or Margules

2                          | 2 endmembers 
sp       herc    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(sp herc) 7d2 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 1
z(Fe) = 1 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                            valid for T>800C<1300C

Mt(W)                                 Wood et al 1991
2                          | model type: Ideal or Margules

2                          | 2 endmembers          
usp      mt
  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(usp mt mt) 42110.      0. 0. 
w(usp usp mt) 10580.      0. 0. 
end_excess_function   


2                          | 2 site model
 
3 2.                       | 3 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt

2 1.                       | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      The Anderson and Lindsley models
                                      (Am Min v 73, p 714, 1988)
                                      are for ilmenite coexisiting with
                                      magnetite, its performance at high 
                                      T (ca 1200) has been criticized by
                                      Ghiorso, but this is probably the
                                      best model for T<800 C                        


IlHm(A)                           
2                          | macroscopic

2                          | 2 endmembers 
ilm      hem
  0  0                     | endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
w(ilm hem hem) 126342.5 -100.6 0. term 1
w(ilm ilm hem) 44204.8 -12.274 0. term 2
end_excess_function

1

2 2. 
z(Ti) = 1 ilm

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ideal ilmenite-geikielite-pyrophanite solution
IlGkPy                                   
2                          | model type: Ideal or Margules

3                          | 3 endmembers
pnt      geik     ilm      
0 0 0                      | endmember flags

                           | restricted mn range! 

0. .2 0.1    1             | imod = 1 -> asymmetric transform subdivision
0. 1. 0.1    0             | imod = 0 -> cartesian subdivision
ideal

1                          | 1 site entropy model

3 1.                       | 3 species, site multiplicity of 1
z(Mn) = 1 pnt
z(Mg) = 1 geik

end_of_model               
                      --------------------------------------------------------
begin_model                

MtUl(A)                    | Anderson and Lindsley 1988, Akimoto model
2                          | model type: Ideal or Margules

2                          | 2 species
usp      mt
  0  0                                endmember flags
0. 1. 0.1 0                | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(usp mt mt) 46175. -23.077 0. 
w(usp usp mt) 15748.      0. 0. 
end_excess_function   

2                          | 2 site model
 
3 2.                       | 3 species on O, 2 sites per formula unit.

z(Ti,O) = 1/2 usp
z(Fe3+,O) = 1/2 mt

2 1.                       | 2 species on T, 1 site per formula unit.
z(Fe3+,T) = 1 mt

end_of_model               
                      --------------------------------------------------------
begin_model                

Neph(FB)                              Ferry and Blencoe '78        
                                       
2                          | macroscopic

2                          | 2 endmembers
ne       kals    
  0  0                                endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(ne kals kals) 85057.0     -20.0500     -.550000
w(ne ne kals) 35945.0      23.7800     0.69 
end_excess_function 

1                          | 1 site model
 
2 1.                       | 2 species, 1 sites per formula unit.
z(na) = 1 ne

end_of_model               
                      --------------------------------------------------------
begin_model                

GrPyAlSp(B)                           Grossular-pyrope-almandine-spessartine, Berman '90,
2                          | macroscopic

4                          | 4 endmembers
gr       py       alm      
spss   
  0  0  0  0                          endmember flags

  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision
  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision
  0.0 1. 0.1 0             | imod = 0 -> cartesian subdivision  

begin_excess_function 
w(gr gr py) 21560.0     -18.79       0.100000     term 1
w(gr py py)  69200.0     -18.79         0.10       term 2
w(gr gr alm)   20320         -5.08        0.17       term 3
w(gr alm alm)  2620.0        -5.08        0.09       term 4
w(py py alm)   230.0      0.     0.01               term 5
w(py alm alm) 3720.0    0.     0.06               term 6
w(gr py alm)  58825.        -23.87       0.265       term 7
w(gr py spss)  45424.     -18.7900     0.100000      term 8
w(gr alm spss)  11470.0     -18.7900     0.130000     term 9
w(py alm spss) 1975.00  0.     0.035000             term 10
end_excess_function 

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ganguly preliminary wohl model fit

GrPyAlSp(G)                           Grossular-pyrope-almandine-spessartine
2                                     model type: Ideal or Margules

4 
gr       py       alm               
spss   
  0  0  0  0                          endmember flags
  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision
  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision
  0.0  1. 0.1 0            | imod = 0 -> cartesian subdivision

begin_excess_function
w(py py gr) 59304. -10.5  .036  term 1  w12
w(gr gr py) 25860. -10.5  .174  term 2  w21
w(alm alm gr) 2619. -5.07  .09    term 3  w13
w(gr gr alm)  20319. -5.07 .09    term 4  w31
w(spss spss gr) 1425.0   0.     0.  term 5  w14
w(gr gr spss)  1425.0 0.     0.    term 6  w41
w(py py alm)  6351.  0. .06       term 7  w23
w(py alm alm)  2085.  0. .009      term 8  w32
w(py spss spss)  30345. -15.6  0.    term 9  w24
w(py py spss) 30345. -15.6  0.    term 10 w42
w(alm alm spss)  1860.0 0. 0.        term 11 w34
w(alm spss spss) 1860.0 0. 0.        term 12 w43
w(gr py alm) 58269. -15.57 .2295 term 13 (w12+w21+w13+w31+w23+w32)/2
w(gr py spss) 74352. -26.1 .105   term 14 (w12+w21+w14+w41+w24+w42)/2
w(gr alm spss)  14754. -5.07 .09    term 15 (w13+w31+w14+w41+w34+w43)/2
w(py alm spss) 36423. -15.6 .0345  term 16 (w23+w32+w24+w42+w34+w43)/2
w(gr py alm spss) 91899. -31.17 .2295 term 17 (w12+w21+w13+w31+w14+w41+w23+w32+w24+w42+w34+w43)/2
end_excess_function

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr


end_of_model               
                      --------------------------------------------------------
begin_model                
                                      hp '98 quaternary garnet model

Gt(HP) 
2                                     model type: Margules, endmember fractions.                                                                               

4                                     number of endmembers 
spss     alm      py       gr         endmember names 

  1  0  0  0                        | endmember flags

0. 0.2  0.1 1              | imod = 1 -> asymmetric transform subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
0. 1.   0.1 0              | imod = 0 -> cartesian subdivision
                           | NOTE restricted subdivision range on Mn (Species 1)!

begin_excess_function
w(py gr) 33000. 0. 0.  
w(alm py)  2500.  0. 0.               | hp '98 give 2.4 kJ
w(py spss) 4500.  0. 0.  
w(alm spss)  240.   0. 0.
end_excess_function  

1                                     1 site entropy model

4 3.                                  4 species, site multiplicity 3
z(Fe) = 1 alm
z(Mg) = 1 py
z(Ca) = 1 gr

end_of_model               
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                             Mg-Fe-Ca-Al-Fe3 Garnet
                             Hybrid Holland & Powell + Engi & Wersin
                             The Engi & Wersin terms for the excess energy 
                             are suspect and should probably be set to zero.
                                         

Gt(EWHP)                                                                                 
7                              |  model type: Ideal or Margules
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2
gr   alm  py   
andr FA_d MA_d      

2                              | 2 dependent endmembers 
MA_d = -1 gr +  1 py  + 1 andr 
FA_d = -1 gr +  1 alm + 1 andr

0  0  0 0 0 0                  | endmember flags   0 include it   1 drop it            
0. 1. .1 0                     | range and resolution for XCa on A
0. 1. .1 0                     | range and resolution for XFe on A

0. 1. .1                       | range and resolution for XAl on B
0                              | subdivision scheme : imod = 0 -> cartesian

begin_excess_function 
w(py gr) 33d3 0. 0.
w(gr andr andr) 25812 0. -0.52  | eliminate this terms to make Fe3+ - Al exchange ideal
w(andr gr gr)  -93820 0. -0.11  | eliminate this terms to make Fe3+ - Al exchange ideal
end_excess_function 
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr + 1 andr 
z(Mg) = 1 py + 1 MA_d
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py 
end_of_model                  
                              --------------------------------------------------------
begin_model 


                                  Ca-Fe2+-Mg-Al-Fe3+ Garnet model after White, Powell & Holland (JMG, 2000)

                                  Model entered by Lucie Tajcamanova, May 11, 2007. . 

                                  w(alm py) value and reference corrected, Thomas Wagner, June 22, 2007.

                                  Interaction parameters (W terms) updated to the current THERMOCALC "preferred"
                                  values, Van Laar size parameters, added spessartine, Mark Caddick, Nov, 07.

                                  Deleted kho_i interaction term, JADC, Nov 07.



                                                      1       2      
                                                      X       Y 
                                                     _____________

                                      Mutliplicity    3       2     
                                                     _____________

                          Dependent:   fkho_i        Fe      Fe3+      
                          Dependent:   kho_i         Mg      Fe3+
                          Dependent:   fmn_i         Mn      Fe3+
                                       andr          Ca      Fe3+
   
                                       spss          Mn      Al
                                       alm           Fe      Al     
                                       py            Mg      Al     
                                       gr            Ca      Al          
                                                      ____________             
                                      

Gt(WPH) 
    
7                            | model type: Margules with dependent endmembers .

2                            | the number of independent subcompositions, reciprocal solution if > 1.

4  2                         | 4 species on site 1, 2 species on site 2. 
                             | M2 and M1 can be identified as sites 1 and 2, respectively. the
                             | species that mix on site 1 are Mn-Mg-Fe-Ca and the species that mix on 
                             | site 2 are Al-Fe3+.                                                                          

          
spss   alm      py     gr    | endmember names 
fmn_i  fkho_i   kho_i  andr


3                                 | number of dependent endmembers 

fmn_i = 1 andr + 1 spss -1 gr
fkho_i = 1 andr + 1 alm -1 gr    
kho_i = 1 andr + 1 py -1 gr  


0  0  0  0  0  0  0  0            | endmember flags

0. .2   0.1 1                     | imod = 0 -> cartesian subdivision (xmn) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xfe) on X
0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision (xmg) on X


0. 1.   0.1 0                     | imod = 0 -> cartesian subdivision x(fe3+) on Y

                            
begin_excess_function
                                  | previous values commented:
w(alm gr) 15000. 0. 0.
w(py gr) 80000. 0. 0. 
                                  | w(py gr) 33000. 0. 0.   
w(alm py)  2500.  0. 0.   
                                  | w(alm py)  0. 0. 0.       
w(py andr) 160000.  0. 0.  
                                  | w(py andr) 73000.  0. 0. 
w(alm andr)  135000.  0. 0.
                                  | w(alm andr)  60000.  0. 0.   
end_excess_function  

2                                     |2 site entropy model

4 3.                                  |4 species, site multiplicity 3
z(x,mn) = 1 spss 
z(x,fe) = 1 alm 
z(x,Mg) = 1 py 

2 2.                                  |2 species, site multiplicity 2
z(y,al) = 1 spss + 1 alm + 1 py + 1 gr


begin_van_laar_sizes             
alpha(py)     0.1    0.0    0.0                      
alpha(alm)    0.1    0.0    0.0                      
alpha(spss)   0.1    0.0    0.0
alpha(gr)     0.9    0.0    0.0
alpha(andr)   0.9    0.0    0.0
end_van_laar_sizes

end_of_model      
                      --------------------------------------------------------
begin_model                
                                  berman and brown 1984, cao-al2o3-sio2 melt
                                  model. reformulated as macroscopic Aug 21, 2007.
casmelt                                                         
2                          | model type: macroscopic
3                          | 3 species 
SIO2     AL2O3    CAO      | endmember names 
  0  0  0                  | endmember flags
0. 1. 0.1 0                | cartesian
0. 1. 0.1 0          


begin_excess_function
w(SIO2 AL2O3 AL2O3 AL2O3)  63617.2     -23.7400  0. term 1
w(SIO2 SIO2 AL2O3 AL2O3)  0.164266d7 -763.870  0. term 2
w(SIO2 SIO2 SIO2 AL2O3)   -106635.      28.1300  0. term 3
w(SIO2 CAO CAO CAO)       -898693.      240.770  0. term 4
w(SIO2 SIO2 CAO CAO)      -350208.     -48.6200  0. term 5
w(SIO2 SIO2 SIO2 CAO)     -14081.8     -35.4900  0. term 6
w(AL2O3 CAO CAO CAO)      -455634.      2.47000  0. term 7
w(AL2O3 AL2O3 CAO CAO)    -725166.      255.390  0. term 8
w(AL2O3 AL2O3 AL2O3 CAO)  -240215.      26.7000  0. term 9
w(SIO2 SIO2 AL2O3 CAO)    -.284791d7  1046.35  0. term 10
w(SIO2 AL2O3 AL2O3 CAO)   -.214904d7  641.840  0. term 11
w(SIO2 AL2O3 CAO CAO)       209109.     -313.360  0. term 12
end_excess_function

1                                     1 site molecular entropy model

3 1.                                  3 species, site multiplicity 1
z(SIO2) = 1 SIO2          
z(AL2O3) = 1 AL2O3

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

A-phase                               ideal phase A                                          
2                          | macroscopic

2
phA      fphA      
  0  0                                endmember flags
 0.  1.  0.1  1            | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 7.                       | 2 species, 7 sites pfu
z(mg) = 1 phA

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

Chum                                  ideal clinohumite                                          
2                          | macroscopic

2
chum     fchum     
  0  0                                endmember flags
 0.  1.  0.1   1           | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 9.                       | 2 species, 9 sites pfu
z(mg) = 1 chum

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

Atg                                   ideal antigorite                                          
2                          | macroscopic

2 
atg      fatg     
  0  0                                endmember flags
 0. 1. 0.1   1             | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 48.                      | 2 species, 48 sites pfu
z(mg) = 1 atg    

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

B                                     ideal brucite                                           
2                          | macroscopic

2                                isp(1)
br       fbr      
  0  0                                endmember flags
 0.  1. 0.1  1             | subdivision range, imod = 1 -> asymmetric transform subdivision

ideal 

1                          | 1 site entropy model 
2 1.                       | 2 species, 1 site pfu
z(mg) = 1 br

end_of_model               
                      --------------------------------------------------------
begin_model                

P                                     ideal periclase                                           
2                          | macroscopic

2                          | 2 endmembers 
per      fper      
  0  0                                endmember flags
 0.  1.  0.1  1            | subdivision range, imod = 1 -> asymmetric transform subdivision
ideal 

1                          | 1 site entropy model 
2 1.                       | 2 species, 1 site pfu
z(mg) = 1 per

end_of_model               
                      --------------------------------------------------------
begin_model   
             
Fphl                                  Ideal, for holland and powell                                      
1                          | model type: Ideal or Margules
1
  2  2                                isp(1), ist(1) 
phl      fphl      
  0  0                                endmember flags
 0.0 1.0 0.1 0                        subdivision ranges and model
  0  0                                iterm, iord 
  0                                   msite

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | Ottonello (1992) CMP 111:53-60 C2/c cpx Wohl model.
                           | Because Ottonello chose to use 4 endmembers it
                           | is necessary to formulate this model as a solution
                           | with 2 independent subcompositions. I forget
                           | which site Ca occupies, so I assume the following
                           | site occupancies M1: Ca, Mg, Fe  & M2: Mg, Fe
                           | with no preferential partitioning of Fe and Mg.


                                                                    JADC
Qpx                        | solution name (a10 format).
1                          | model type: Ideal or Margules
2                          | 2 independent mixing site.
2 1 2 1                    | 2 species mix on each site, site multiplicity undefined, see below.
cen      cfs      di       | endmembers, this implies: x(11) = x(mg,m2)
hed                        | x(12) = x(fe,m2); x(22) = x(ca,m1); x(21) = x(mg+fe,m1)
0 0 0 0                    | endmember flags
0. 1. .1  0          | subdivision for site 1 (range of x(mg))
0. 1. .1  0          | subdivision for site 2 (range of x(ca))
15 4                       | 15 terms, maximum order 4.

1 1 2 1 2 1 0 0            | x1*x2*x2*w12 
-1558.6 -24.389  0.0282 0. 0.
1 1 1 1 2 1 0 0            | x1*x1*x2*w21
2518.6  -24.651  0.0226 0. 0.
1 1 1 2 1 2 0 0            | x1*x3*x3*w13
23633.1 -.016    .0208  0. 0.
1 1 1 1 1 2 0 0            | x1*x1*x3*w31
32467.3 .007     .0066  0. 0.
1 1 2 2 2 2 0 0            | x1*x4*x4*w14
50774.2 -38.907  0.0771 0. 0.
1 1 1 1 2 2 0 0            | x1*x1*x4*w41
27841.2 -24.609  0.0510 0. 0.
2 1 2 2 2 2 0 0            | x2*x4*x4*w24
16109.3 -0.033   0.0453 0. 0.
2 1 2 1 2 2 0 0            | x2*x2*x4*w42
20099.8 0.034    0.053  0. 0.
1 2 2 2 2 2 0 0            | x3*x4*x4*w34
13984.2 0.001    0.0068 0. 0.
1 2 1 2 2 2 0 0            | x3*x3*x4*w43
17958. -0.004 -0.0084   0. 0.
1 1 2 1 1 2 0 0            | x1*x2*x3*((w12+w21+w13+w31+w23+w32)/2 - w123)
62567.65 -30.72 .12845  0. 0.
1 1 2 1 2 2 0 0            | x1*x2*x4*((w12+w21+w14+w41+w24+w42)/2 - w124)
145758.65 -35.6655 .1198 0. 0.
1 1 1 2 2 2 0 0            | x1*x3*x4*((w13+w31+w14+w41+w34+w43)/2 - w134)
122346.2 2.711 .17045 0. 0.
2 1 1 2 2 2 0 0            | x2*x3*x4*((w23+w32+w24+w42+w34+w43)/2 - w234)
12009.6 5.3095 .2165  0. 0.
1 1 2 1 1 2 2 2            | x1*x2*x3*x4*((w12+w21+w13+w31+w14+w41+w23+w32+w24+w42+w34+w43)/2-w1234)
60427.7 227.426 -.28785  0. 0.

2                          | 2 mixing sites, M2, M1


2 4.                       | 2 species on M2, 2 sites per formula unit.

1 0.                       | z(11) = x(Mg,M2) = x(11) so 1 term and a0(11) = 0.
1                          | 1-x term
1. 1 1                     

3 2.                       | 3 species on M2, 2 sites per formula unit.

1 0.0                      | z(21) = z(Ca,M1) = x(21) so 1 term and a0(21) = 0.
1                          | 1-x term
1  2 1                     

2 0.                       | z(22) = z(Mg,M1) = (1-x(21))*x(11) = x(11) - x(11)*x(21)
1                          | 1-x term
1.  1 1                    | 
2                          | 2-x term
-1. 1 1  2 1               |

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                           | Lindsley
lcENDI                     | solution name (a10 format).
1                          | model type: Ideal or Margules
1                          | 2 independent mixing site.
2 1                        
CEN      di                | endmembers, this implies: x(11) = x(mg,m2)
0 0                        | endmember flags
0 1. 0.1 0     
2 3                        | 15 terms, maximum order 4.
1 1 1 2 1 2                | x1*x3*x3*w13
25484. 0. .0812  0. 0.
1 1 1 1 1 2                | x1*x1*x3*w31
31216. 0. -.0066 0. 0.
0                          | 0 mixing sites, M2, M1

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                           | Lindsley

lcFSHD                     | solution name (a10 format).
1                          | model type: Ideal or Margules
1                          | 1 independent mixing site.
2 1                        | 2
CFS      hed               | endmembers, this implies: x(11) = x(mg,m2)
0 0                        | endmember flags
0.  1. 0.1 0              | subdivision for site 1 (range of x(mg))
2 3                        | 2 terms, maximum order 3.
1 1 1 2 1 2                | x2*x4*x4*w24
16941. .0  0.0059 
1 1 1 1 1 2                | x2*x2*x4*w42
20697. .0  -.00235
0                          | molecular configurational entropy

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

humite                     | solution name. jadc.
1                          | model type: Ideal or Margules
2                          | 2 independent mixing site.
2 1 2 2                    | 2 species mix on each site, site multiplicity undefined, see below.
mgoh     mtoh     mgf2     | endmembers, order implies: x(11)=x(mg);
mtf2                       | x(12) = x(mgti); x(21) = x(oh); x(22) = x(f2) 
0 0 0 0                    | endmember flags
0. 1. 0.1  0               | cartesian subdivision for site 1 (gives range of x(mg))
0. 1. 0.1  0               | cartesian subdivision for site 2 (gives range of oh).
2 3                        | iterm, iord.
2 1 2 2 2 2                  xoh xf xf 
-59099.0 0. 0. 0. 0.
2 2 2 1 2 1                   
-21564.0 0. 0. 0. 0.
2                          | msite, 3 sites, M, A.

2 1.                       | 2 species on M, 1 site per formula unit.

1 0.5                      | z(11) = .5 + .5 x(mg,m) = z(mg)
1                          | 1-x term
0.5 1 1                    |

3 2.                       | 3 species on A, 2 sites per formula unit.

1 0.0                      | z(21) = z(O) = x(12)
1                          | 1-x term
0.5 1 2                    |

2 0.0                      | z(22) = z(OH) = x21 - 0.5 x21 x12

1
1.0 2 1
2
-0.5 2 1 1 2

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                           dummy model to produce pseudocompounds for the Toop-Samis
                           model, the first endmember must be sio2, the remaining 
                           endmembers must be entered in order of increasing at wt of
                           the cation, i.e. na, mg, al....., with the present format
                           you are going to be limited to 4 component melts, dum1 and
                           dum2 will be ignored by vertex (i.e., if it doesn't find 
                           the endmember in the thermodynamic data file it will eliminate
                           the component from the model. 

Toop-Melt                               
23                                    model type: Toop internal EoS

4                                     number of endmembers
SIO2     CAO      DUM1              | endmember names
DUM2  
  0  0  0  0                          endmember flags
  0. 1. 0.1 0 
  0. 1. 0.1 0 
  0. 1. 0.1 0  subdivision ranges and model

ideal

1                                     3 site entropy model
4 3.                                  4 species, multiplicity = 3
z(Ca) = 1 CAO
z(Si) = 1 SIO2
z(DUM1) = 1 DUM1

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

Mn-Opx                     | solution name 
1                          | model type: Ideal or Margules
2                          | 2 independent mixing site.
3 1 2 1                    
en       fs       don
mgts     fets     dts                  
0 0 0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.
0.0  1.0  0.1  0
0.0  1.0  0.1  0               | pseudocompound model for site 1 
0.0  1.0  0.1  0               | pseudocompound model for site 2 
2 3                            | iterm, iord, non-ideal Fe-Mg mixing
1 1 1 2 0 0                  
1000. 0. 0. 
1 1 1 2 2 2                  
-500. 0. 0. 

3                          | msite, 3 sites, M1, M2, T.

3 1.                       | 3 species on M2, 1 site per formula unit.

1 0.                       | z(11) = x(mg,m2) = x(11) so 1 term and a0(11) = 0.
1                          | 1-x term
1. 1 1                     |

1 0.                       | z(12) = x(fe,m2) = x(12) so 1 term and a0(12) = 0.
1                          | 1-x term
1. 1 2                     |


2 2.                       | 2 species on T, 2 sites per formula unit.

1 0.                       | z(21) = z(al,t) = x(22)/2, so 1 term and a0(21) = 0
1                          | 1-x term
0.5 2 2                    |

4 1.                       | 4 species on M1, 1 site per formula unit.

1 0.                       | z(31) = z(al,t) = x(22)/2, so 1 term and a0(31) = 0.
1                          | 1-x term
0.5  2 2                   |

2 0.                       | z(32) = z(mg,m2) = x(11)(1-z(31)) = x(11) - x(11)x(22)/2
1                          | 1-x term
1.  1 1                    | 
2                          | 2-x term
-.5 1 1  2 2               |

2 0.                       | z(33) = z(fe,m2) = x(12)(1-z(31)) = x(12) - x(12)x(22)/2
1                          | 1-x term
1.  1 2                    | 
2                          | 2-x term
-.5 1 2  2 2               |

end_of_model               
                      --------------------------------------------------------
begin_model                
                             Ternary feldspars (Holland and Powell, 2003, CMP, p.492-501) 
                             Van Laar Versions. 

                             USE THIS MODEL WITH EXTREME CAUTION (AND DON'T USE THE 
                             MODEL IF YOU DON'T UNDERSTAND THE IMPLICATIONS OF THIS
                             WARNING):

                             The model has the following difficulties for the Ab-An
                             binary and they undoubtedly cause problems in the ternary:

                             1) The I1/C1 models are not (and cannot be used to) predict
                                the stable structural state, the I1 model is always more
                                stable than the C1; thus the "stable" state is supposed
                                to be chosen by assuming the C1 model is valid at 
                                X(Ab) > 1 - (0.12+0.00038*TK).

                             2) The model assigns a large positive interaction term for
                                I1 plagioclase, as a result the I1 model gives a solvus
                                that closes at ~ 910 K. At temperatures below the critical
                                temperature plagioclases in vicinity of the prescribed
                                I1/C1 transition (as defined in 1, above), that in principle 
                                is supposed to be stable, is metastable with respect to 
                                a mixture of I1 and C1 plagioclase.

                             JADC 1/04
                             
                             MORE NOTES:  

                             * These models use the asymmetric formalism as outlined by H & P.

                             * They are complicated by the C1/I1 transition across the plag. join.
                                           
                             * Model parameters for the C1 field (Ab-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000 
                                 Wanab  = 3100
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Ian    = 7030 - 4.66*T

                             * Model parameters for the I1 field (An-rich plag. component)
                                 Wabsan = 25100 - 10.8*T + 0.343*P
                                 Wansan = 40000 
                                 Wanab  = 15000
                                 a-san  = 1.0
                                 a-ab   = 0.643
                                 a-an   = 1.0
                                 Iab    = 570 - 4.12*T

                             D.Tinkham, 12-18-2003

                             reformatted and compositional ranges chosen given the following
                             considerations (JADC 12/03):
                                
                             * On the Ab-An join C1 is not stable below ~ 800 K,
                               and has X(An) < 0.4 and I1 is not stable for 
                               X(An) < 0.6 

                             * On the Ab-Or join C1 is always stable, with critical
                               composition X(Ab) ~ 0.34
                        
                             * The above considerations suggest the I1 model could be effectively represented
                               by a binary An-Ab (with X(Ab)>0.2) model; and the C1 model
                               should be split into a model with X(ab) < 0.33 with 
                               extensive ternary solution; and a model with X(Ab) > 0.33
                               with very limited ternary solution. Assuming these relationships
                               are valid the ternary feldspar phase relations are well 
                               represented by three solutions models

                               AbFsp(C1) and OrFsp(C1) - represent Ab-rich ternary feldspar
                               and Or-rich essentially binary (Ab-Or) feldspar, all with the
                               C1 structural state

                               Pl(I1) - represents essentially binary (Ab-An) anorthite
                               rich I1 structural state feldspar. 

                               A negative consequence of using AbFsp(C1) and OrFsp(C1) to
                               represent supercritical feldspar is the models produce 
                               a mock "solvus" where the compositional ranges abut. 

                             -----------------------------------------------------------
                             | See WARNING above for HP ASF Ternary Feldspar

OrFsp(C1)                    | solution name. To be used with Pl(I1,HP) and AbFsp(C1).

2                            | model type: van laar as formulated by Holland & Powell (macroscopic formulation)

3                            | number of endmembers

an       
san 
abh  
      
 0  1  1                     | endmember flags

0.    0.1  0.1 0             | compositional range and resolution of an
0.34  1.0  0.1 0             | compositional range and resolution of san 

begin_excess_function 
w(san abh)     25100.  -10.8  0.343
w(san an)      40000.    0.   0. 
w(abh an)       3100.    0.   0. 
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            
                           
begin_van_laar_sizes                        
alpha(san)     1.0    0.0    0.0                      
alpha(abh)     0.643  0.0    0.0                      
alpha(an)      1.0    0.0    0.0
end_van_laar_sizes

begin_dqf_corrections
dqf(an) 7030 -4.66 0
end_dqf_corrections

end_of_model                 
                      --------------------------------------------------------
begin_model                  
                             | See WARNING above for HP ASF Ternary Feldspar

AbFsp(C1)                    | solution name. To be used with Pl(I1,HP) and OrFsp(C1).

2                            | model type: van laar as formulated by Holland & Powell (macroscopic formulation)

3                            | number of endmembers

abh  
san  
an 
      
 0  1  1                     | endmember flags

0.66 1.   0.1  0             | compositional range and resolution of abh 
0.   1.   0.1  0             | compositional range and resolution of san

begin_excess_function 
w(san abh)     25100.  -10.8  0.343
w(san an)      40000.    0.   0. 
w(abh an)       3100.    0.   0. 
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            
                           
begin_van_laar_sizes                        
alpha(san)     1.0    0.0    0.0                      
alpha(abh)     0.643  0.0    0.0                      
alpha(an)      1.0    0.0    0.0
end_van_laar_sizes

begin_dqf_corrections
dqf(an) 7030 -4.66 0 
end_dqf_corrections

end_of_model                 
                      --------------------------------------------------------
begin_model                 
                             | This model should be used in conjunction with
                             | AbFsp(C1) and OrFsp(C1)

Pl(I1,HP)                    | solution name.

2                            | model type: van laar as formulated by Holland & Powell (macroscopic formulation)
 
3                            | number of endmembers

san    
abh     
an 
      
 1  1  0                     | endmember flags


 0. 1.  0.1  0              | compositional range and resolution of san
 0. 1.  0.1  0              | compositional range and resolution of abh

begin_excess_function 
w(san abh)         25100.  -10.8  0.343
w(san an)          40000.    0.   0. 
w(abh an)          15000.    0.   0. 
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            | van laar volumes follow:

                             
begin_van_laar_sizes                        
alpha(san)     1.0    0.0    0.0                      
alpha(abh)     0.643  0.0    0.0                      
alpha(an)      1.0    0.0    0.0
end_van_laar_sizes

begin_dqf_corrections
dqf(abh) 570 -4.12 0
end_dqf_corrections

end_of_model                
                      --------------------------------------------------------
begin_model                  
                             | See WARNING above for HP ASF Ternary Feldspar

Fsp(C1)                      | solution name. To be used with Pl(I1,HP)

2                            | model type: van laar as formulated by Holland & Powell (macroscopic formulation)
 
3                            | number of endmembers

an   
san 
abh  
      
 0  1  1                     | endmember flags

0.    1.0  0.1   0           | compositional range and resolution of an
0.    1.0  0.1   0           | compositional range and resolution of san 

begin_excess_function 
w(san abh)     25100.  -10.8  0.343
w(san an)      40000.    0.   0. 
w(abh an)       3100.    0.   0. 
end_excess_function  

1                            | 1 site entropy model 
3 1.                         | 3 species, site multiplicity of 1
z(Ca) = 1 an
z(K)  = 1 san            
                           
begin_van_laar_sizes                        
alpha(san)     1.0    0.0    0.0                      
alpha(abh)     0.643  0.0    0.0                      
alpha(an)      1.0    0.0    0.0
end_van_laar_sizes

begin_dqf_corrections
dqf(an) 7030 -4.66 0 
end_dqf_corrections

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                
                                      HP '03 CMP van Laar
                                      Calcite-Magnesite with Dolomite
                                      compound formation.

oCcM(HP)     
2                                     model type van laar.                                                                         

3                                     number of endmembers
cc       mag      odo       
  0  0  0                             endmember flags
0. 1. 0.1  0                        | range and increments on X(cc)
0. 1. 0.1  0                        | range and increments on X(mag)

begin_excess_function             
w(cc mag) 35000. 0. 0. 
w(cc odo) 10250. 0. 0. 
w(mag odo) 14950. 0. 0.
end_excess_function  

2                                     2 site (m1  m2) entropy model 

2 0.5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1 cc + 1 odo 

2 0.5                                 2 species on m1, mult. = 1/2
z(m1,Ca) = 1 cc                 

begin_van_laar_sizes                        
alpha(cc)     0.5 0.000546 0.0                      
alpha(mag)    1.0 0.       0.0                     
alpha(odo)    0.7 0.       0.0 
end_van_laar_sizes

end_of_model               
                      --------------------------------------------------------
begin_model 
                            Tourmaline model with no Li formulated as a hexary
                            solution.

                            NOTE: ffoit, mfoit, drav and shrl are linearly dependent

                                                             1       2          3      
                                                             x       y          z
                                                          _________________________
    
                                             Mutliplicity    1       3          6 
                                                          _________________________

                            Species:         1 drav          Na      Mg3        Al6   
                                             2 uvit          Ca      Mg3        MgAl5
                                             3 mfoit         vac     Mg2Al      Al6
                                             4 shrl          Na      Fe3        Al6
                                             5 olen          Na      Al3        Al6  
                                             6 ffoit         vac     Fe2Al      Al6
                                                           ________________________

                                         Vincent van Hinsberg <v.j.vanHinsberg@bristol.ac.uk> 

Tour(V)                      | solution name.

2                            | model type: margules in terms of endmember fractions

6                            | 6 species mix on the chemical mixing site

drav   uvit   mfoit          | endmember names
shrl   olen   ffoit          | 
0 0 0 0 0 0                  | endmember flags, indicate if the endmember is part of the solution.

0. 1. .1  0                 | range drav
0. .2 .1  0                 | restricted range uvit
0. 1. .1  0                 | range mfoit
0. 1. .1  0                 | range shrl
0. 1. .1  0                 | range olen

ideal

3                            | configurational entropy: 3 sites

3 1.                         | 3 species on X, 1 site per formula unit.
z(na,x) = 1 drav  + 1 shrl + 1 olen   
z(ca,x) = 1 uvit           


3 3.                         | 3 species on Y, 3 sites per formula unit.
z(mg,y) = 1 drav + 1 uvit + 2/3 mfoit
z(al,y) = 1/3 mfoit + 1 olen + 1/3 ffoit 
     

2 6.                         | 2 species on Z, 6 site per formula unit.
z(al,z) = 1 drav + 5/6 uvit + 1 mfoit + 1 shrl + 1 olen + 1 ffoit 

end_of_model 
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                                      dolomite order disorder model


                                                         Site:
                                                       1      2      
                                                       M1     M2
                                                     ____________

                                      Mutliplicity     1     1      
                                                     ____________

                                      1 adol           Ca     Mg   
                            Species:  2 bdol          CaMg   CaMg  
                                                      ___________



DoDo    
2                                     model type margules.                                                                         

2                                     number of endmembers
adol
bdol   
  0  0                              endmember flags
0. 1. 0.1   0                     | range and increments on X(cc)

ideal 

2                                     2 site (m1  m2) entropy model 

2 0.5                                 2 species on m2, mutiplicity = 1/2
z(m2,Ca) = 1/2 bdol

2 0.5                                 2 species on m1, mult. = 1/2
z(m1,Mg) = 1/2 bdol                 

end_of_model               | end of model keyword

begin_model                
                                      magnesio-wuestite solution, after fabrichnaya '99

Wus(fab)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
per       wus            
  0  0                           | endmember flags
0.0 1.0  0.1 0                   | subdivision range, imod = 0 -> cartesian subdivision
  

begin_excess_function
W(per wus)  24d3 -0. 0.          | was 24d3   
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      akimotoite (ilmenite-structure) solution, after fabrichnaya '99

Aki(fab)                                                                                                 
2                                     model type: Margules, macroscopic

3                                    3 endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(aki cor)  60000.0 0. 0. 
W(faki cor) 60000.0 0. 0.              
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, after fabrichnaya '99
Pv(fab)                                                                               
2                                     model type: Margules, macroscopic

3                                    3 endmembers
aperov   perov   fperov            
  0  0  0                           | endmember flags

0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
W(perov aperov)   49000.0 0. 0. 
W(fperov aperov)  49000.0 0. 0.              
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, after oganov. the fppv and 
                           | appv endmembers are henry's law ss. 
Ppv(og)                                                                               
2                                     model type: Margules, macroscopic

3                                    3 endmembers
appv  ppv   fppv            
  0  0  0                           | endmember flags

0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

ideal 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      olivine solution
O(stx)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 14400.0 0. 0.     | was 7200.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model               
                                    Wadleysite solution
Wad(stx)                                                                               
2                          | model type: Margules, macroscopic

2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 3000. 0. 0.            | was 1500.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ringwoodite solution
Ring(stx)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7800.  0. 0.          | was 3900.
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 28800.  0. 0.            | was 7200.
end_excess_function 

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Garnet solution.

                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears the B site should be split into two M-sites
                                      for the 05 paper.

Gt(stx)                                                                               
2                                     model type: Margules, macroscopic
4                                     4 endmembers
gr   alm  maj  py             
 0  0  0  0                         | endmember flags
0. 1. .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

ideal

3                                     3 site entropy model

3 3.                                  3 species, A site multiplicity = 3.
z(A,ca) = 1 gr
z(A,fe) = 1 alm

2 1.                                  2 species, M1 site multiplicity = 1.
z(M1,Mg) = 1 maj 

2 1.                                  2 species, M2 site multiplicity = 1.
z(M1,Si) = 1 maj 


end_of_model               
                      --------------------------------------------------------
begin_model                
                                      C2/c pyroxene solution
C2/c(stx)                                                                               
2                                     model type: Margules, macroscopic
2                                     2 endmembers
c2/c      fc2/c            
  0  0                     | endmember flags
0. 1. .1  0                | subdivision range, imod = 0 -> cartesian subdivision
ideal

1                                     1 site entropy model

2 4.                                  2 species, site multiplicity = 4.
z(mg) = 1 c2/c

end_of_model              
                      --------------------------------------------------------
begin_model                
                                      Opx solution

                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder is assumed across all 4 M sites,
                                      for the 05-07 papers.
Opx(stx)                                                                               
2                                     model type: Margules, macroscopic
3                                     3 endmembers
en   fs   ts        
 0  0  0                            | endmember flags
0. 1. .1  0                         | range and resolution for X(en)
0. 1. .1  0                         | range and resolution for X(fs)

ideal

1                                     1 site entropy model

3 4.                                  3 species, M site multiplicity = 4.
z(M,al) = 1/2 ts
z(M,fe) = 1 fs



end_of_model                        
                      --------------------------------------------------------
begin_model                

                                      Cpx solution, entropy model not specified
                                      by stixrude, additionally there is some 
                                      ambiguity about his excess term, here i
                                      assume its Gex = X(M1,Ca)*X(M1,M)*W.

Cpx(stx)                                                                               
2                                     model type: Margules, macroscopic

3                                     3 endmembers
di  hed  mdi        
 0  0  0                            | endmember flags

0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)   52000.0 0. 0.            
W(mdi hed)  52000.0 0. 0.           
end_excess_function 

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model   
                      --------------------------------------------------------
begin_model                
                                      Stixrude pers com (10/07) indicates
                                      Gex = X(M1,Ca)*X(M1,Mg)*W.
                                      JADC 12/07

                                      Corrected excess function to include 
                                      W(mdi hed), 9/08, JADC.
Cpx(stx7)                                                                               
2                                     model type: Margules, macroscopic

3                                     3 endmembers
di  hed  mdi        
 0  0  0                            | endmember flags

0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)

begin_excess_function
W(mdi di)    52600.0 0. 0.
W(mdi hed)   52600.0 0. 0.           
end_excess_function 

2                                     2 site entropy model

2 2.                                  2 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi

2 2.                                  2 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed

end_of_model                        
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                             Ideal orthoamphibole, this model assumes Al is present
                             on only two tetrahedral sites and all five M2 sites. 
                             I have no idea if this is correct! 

                             fgedr endmember stoichiometry corrected, T. Wagner 2/18/06. 

                                                                 
                                                      M1      M2        T    
                                                     ______________________

                                      Mutliplicity    2       5         2
                                                     ______________________

                                      1 anth          Mg      Mg       SiSi
                            Species:  2 fanth         Fe      Fe       SiSi
                                      3 ged           Mg      Mg3Al2   AlAl
                                      4 fged          Fe      Fe3Al2   AlAl
                                                      ______________________


                           Dependent: fged = ged + 5/7*(fanth - anth)


o-Amph                     | solution name 

7                          | model type: reciprocal, macroscopic

2                          | 2 site reciprocal solution

2  2                       | 2 species on each site

anth     fanth             | endmember names, this order implies: 
ged      fged_i            | x(11)=x(mg); x(12) = x(fe); x(21) = x(si,t); x(22) = x(Al,t) 

1                          | 1 dependent endmember:

fged_i = 1 ged + 5/7 fanth - 5/7 anth

0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.
0. 1. .1             | range and resolution for X(Mg) on site 1
0                          | subdivision scheme on site 2: imod = 0 -> cartesian
0. 1. .1              | range and resolution for 1-X(Tschermaks) on site 2
0                          | subdivision scheme on site 2: imod = 0 -> cartesian

ideal

3                          | 3 site (M1, M2, T) conigurational entropy model

2 2.                       | 2 species on M1, 2 sites per formula unit.

z(m1,mg) = 1 anth + 1 ged              
                
2 2.                       | 2 species on T, 2 sites per formula unit.

z(t,al) = 1 ged 

3 1.                       | 3 species on M2, 1 site per formula unit.

z(m2,mg) = 1 anth + 3/5 ged
z(m2,fe) = 1 fanth 

end_of_model               | end of model keyword
                              --------------------------------------------------------
begin_model                   | keyword indicating beginning of a solution model

                                      HP '96 Am Min, Non-ideal quasi ordered omphacite,
                                      i.e., compound formation only occurs for omph.
                                      This model should only be used in conjunction with 
                                      Cpx(HP). The value of wdh appears discrepant 
                                      with the value in HP '98.

                                      The interaction parameters here are from the
                                      Omphacite model distributed with the '00 
                                      Thermocalc program. JADC 2/03

                                      Added ideal acm+cats, JADC, 1/06. 

                                      NOTE: this model does not require Mg/(Fe+Mg)
                                      is the same across sites (as done in Thermocalc). 

                                      CORRECTIONS:

                                      enthalpy of ordering corrected from -16 kJ to
                                      -3.5 kJ. JADC, Aug 20, 2003.

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 


                                                         Site:
                                                       1      2      3      4    5
                                                      M2a    M2b    M1a    M1b   T1   
                                                     ____________________________________

                                      Mutliplicity    1/2    1/2    1/2    1/2    1
                                                     ____________________________________

                                      1 Diopside      Ca     Ca     Mg     Mg    Si
                            Species:  2 Jadeite       Na     Na     Al     Al    Si
                                      3 Hedenbergit   Ca     Ca     Fe2+   Fe2+  Si
                                      4 Ca-Tschermaks Ca     Ca     Al     Al    Al
                                      5 Acmite        Na     Na     Fe3+   Fe3+  Si
                                                      ___________________________________

                        Ordered Cpd:  6 Omphacite     Na     Ca     Al     Mg    Si



cOmph(HP)     

6                                     model type margules with compound formation  
                                                                       
5                                     5 disordered endmembers

di       
jd  
cats  
acm   
hed

1                             | ordered species definition

omph = 1/2 jd + 1/2 di enthalpy_of_formation = -35d2 

0  0  0  0  0                 | endmember flags

                              | NOTE RESTRICTED RANGES:
0. 1. 0.1  0                  | range and resolution of X(di)
0. 1. 0.1  0                  | range and resolution of X(jd)
0. 1. 0.1  0                  | range and resolution of X(cats) 
0. 1. 0.1  0                  | range and resolution of X(acm) 

begin_excess_function   
w(di jd)    26000. 0. 0.  
w(omph jd)  16000. 0. 0.  
w(omph di)  16000. 0. 0. 
w(omph hed) 17000. 0. 0. 
w(hed jd)   24000. 0. 0. 
w(di hed)   4000.  0. 0.       | hp 98 give 2.5 kJ
w(cats di)    7d3 0. 0.
w(cats hed)   4d3 0. 0.
end_excess_function

5                                   | 4 site entropy model (m1a, m1b, m2b, m2a)

2 0.5                               | 2 species on m2a, mutiplicity = 1/2

                                    | WARNING! fractions can only be used in the site
                                    | fraction definitions, do not use fractions to specify
                                    | site multiplicities in the above line.


z(m2a,ca) = 1 di + 1 hed + 1 cats

2 0.5                                 2 species on m2b, mult. = 1/2
z(m2a,na) = 1 jd + 1 acm

4 0.5                                 4 species on m1a, mult = 1/2
z(m1a,mg) = 1 di 
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

4 0.5                                 4 species on m1b, mult = 1/2
z(m1b,al) = 1 jd + 1 cats
z(m1a,fe2+) = 1 hed
z(m1a,fe3+) = 1 acm

2 1.0                                 2 species on T1 (perhaps Al should be disordered over T1-T2?)
z(t1,al)  = 1 cats

end_of_model               | end of model keyword
                      --------------------------------------------------------
begin_model                 

                                Mg-Fe-Ca-Al-Cr Garnet
                                Hybrid Holland & Powell + Simon/PGP Cr Workshop
                                (folk.uio.no/ninasim/Cr_results.html)

CrGt
                                                           
7                              | model type: reciprocal
2                              | 2 chemical site model
3 2                            | 3 endmembers mix on site 1, 2 endmembers mix on site 2

uv_d  fuv_d  knor 
gr    alm    py   
     

2                              | 2 dependent endmembers 

uv_d = 1 gr +  1 knor  - 1 py 
fuv_d = 1 alm +  1 knor  - 1 py

0 0 0 0 0 0                    | endmember flags 0 include it   1 drop it    
        
0. 1. .1   0                | range and resolution for  XCa on A
0. 1. .1   0                | range and resolution for  XFe on A

0. 1. .1   1                | range and resolution for  XCr on B

begin_excess_function 
w(py gr) 33d3 0. 0.
 | w(py py gr) 59304. -10.5  .036   Ganguly excess paramters
 | w(py gr gr) 25860. -10.5  .174  
end_excess_function 
2                                     2 site entropy model
3 3.                                  3 species, site multiplicity of 3
z(Ca) = 1 gr + 1 uv_d 
z(Mg) = 1 py + 1 knor
2 2.                                  2 species, site multiplicity of 2
z(Al) = 1 gr + 1 alm + 1 py 
end_of_model                  
                  --------------------------------------------------------
begin_model                

                             Orthopyroxene with compound formation, PH '99 Am Min. 
                             JADC 3/03

                             Modified for ideal Cr, additionally a temperature 
                             dependence of -16 J/K has been assigned adhoc to W(mgts-en)
                             and W(mgts-opx) in order to increase the Al-content of opx
                             for upper mantle compositions and conditions. A better way
                             of accomplishing the same result would be to increase the
                             entropy of mgts. PGP Workshop 4/12/06. 
                             (folk.uio.no/ninasim/Cr_results.html)

                             NOTES:  

                             * This model should not be used for crustal rocks/conditions! 

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.


                                                      1       2             
                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg       
                            Species:  2 fs            Fe      Fe    
                                      3 mgts          Al      Mg         
                                      4 fets          Al      Fe    
                                      5 crts          Cr      Mg
                                      6 fcrts         Cr      Fe
                                                      _____________

                           Internal:  7 opx           Mg      Fe    


                           Dependent: fets = mgts + opx - en
                                      fcrts = crts + opx - en


CrOpx(HP)                  | solution name.

8                          | model type: Reciprocal with speciation

2                          | 2 independent mixing sitea
2 3                        | 2 dimensions on first site, 3 on second
                           | endmember names 
crts     fcrts_d  
mgts     fets_d   
en       fs 
 

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3                    

2                          | 2 dependent endmember

fets_d = 1 mgts + 1 opx - 1 en
fcrts_d = 1 crts - 1/2 en + 1/2 fs


0 0 0 0 0 0                | endmember flags, indicate if endmember is part of the solution.

                           | subdivision model for (binary) site 1 (M2):
0. 1.  .1                  | range and resolution of X(Mg)
0                          | subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1.  .1  1               | range and resolution of X(Cr): imod = 1 -> assymmetric stretching
0. 1.  .1  0               | range and resolution of X(Ts): imod = 0 -> cartesian   

begin_excess_function                
w(en fs)     68d2 0. 0.  
w(fs mgts)  -1d3 -14. 0. 
w(en opx)    45d2 0. 0. 
w(fs opx)    45d2 0. 0. 
w(mgts opx)  12d2 -14. 0. 
end_excess_function 

2                          | 2 site (M1, M2) configurational entropy model

4 1.                       | 4 species on M1, 1 site per formula unit.

z(m1,fe) = 1 fs 
z(m1,al) = 1 mgts + 1 fets_d  
z(m1,cr) = 1 crts + 1 fcrts_d

2 1.                       | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts + 1 crts

end_of_model
                  --------------------------------------------------------
begin_model                

                             Orthopyroxene with compound formation, PH '99 Am Min. 
                             JADC 3/03

                             NOTES:  

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.


                                                      1       2             
                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg       
                            Species:  2 fs            Fe      Fe    
                                      3 mgts          Al      Mg         
                                      4 fets          Al      Fe    
                                                      _____________

                           Internal:  5 opx           Mg      Fe    


                           Dependent: fets = mgts + opx - en


Opx(HP)                    | solution name.

8                          | model type: Reciprocal with speciation

2                          | 2 independent mixing sitea
2 2                        | 2 dimensions on first site, 2 on second
                           | endmember names 
mgts     fets_d   
en       fs 
 

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3                    

1                          | 1 dependent endmember

fets_d = 1 mgts + 1 opx - 1 en


0 0 0 0                    | endmember flags, indicate if endmember is part of the solution.

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1                   | range and resolution of X(Mg)
0                          | subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1                   | range and resolution of X(Ts)  
0                          | subdivision scheme for site 2: imod = 0 -> cartesian  




begin_excess_function                
w(en fs)     68d2 0. 0.  
w(fs mgts)   -1d3 0. 0.  
w(en opx)    45d2 0. 0. 
w(fs opx)    45d2 0. 0. 
w(mgts opx)  12d2 0. 0.   
end_excess_function 

2                          | 2 site (M1, M2) configurational entropy model

3 1.                       | 3 species on M1, 1 site per formula unit.

z(m1,fe) = 1 fs 
z(m1,al) = 1 mgts + 1 fets_d  

2 1.                       | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts 

end_of_model
                  --------------------------------------------------------
begin_model                

                             An ideal OPX model with compound formation
                             to avoid solvii predicted by the OPX(HP). 

                             NOTES:  

                             * This model will only function for the FASH subsystem
                               if MGO is present as a component in VERTEX.


                                                      1       2             
                                                      M1      M2      
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 en            Mg      Mg       
                            Species:  2 fs            Fe      Fe    
                                      3 mgts          Al      Mg         
                                      4 fets          Al      Fe    
                                                      _____________

                           Internal:  5 opx           Mg      Fe    


                           Dependent: fets = mgts + opx - en


Opx(I)                     | solution name.

8                          | model type: Reciprocal with speciation

2                          | 2 independent mixing sitea
2 2                        | 2 dimensions on first site, 2 on second
                           | endmember names 
mgts     fets_d   
en       fs 
 

1                          | ordered species definition

opx = 1/2 en + 1/2  fs  Delta(enthalpy) = -6.95d3                    

1                          | 1 dependent endmember

fets_d = 1 mgts + 1 opx - 1 en


0 0 0 0                    | endmember flags, indicate if endmember is part of the solution.

                           | subdivision model for (binary) site 1 (M2):
0. 1. .1                   | range and resolution of X(Mg)
0                          | subdivision scheme for site 1: imod = 0 -> cartesian 

                           | subdivision model for (ternary) site 2 
0. 1. .1                   | range and resolution of X(Ts)  
0                          | subdivision scheme for site 2: imod = 0 -> cartesian  


ideal 

2                          | 2 site (M1, M2) configurational entropy model

3 1.                       | 3 species on M1, 1 site per formula unit.

z(m1,fe) = 1 fs 
z(m1,al) = 1 mgts + 1 fets_d  

2 1.                       | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en + 1 mgts 

end_of_model
                      --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Added ideal acm+cats, JADC, 1/06. 

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 

                                      Added ideal Cr, PGP Workshop 4/12/06.
                                      (folk.uio.no/ninasim/Cr_results.html)

                                      Corrected    z(m1,al) = 1 jd
                                      to   z(m1,al) = 1 jd + 1 cats
                                      M. Caddick, 5/8/08.

Cpx(HP)

2                                   | model type sf.

6                                   | number of endmembers
ccrts 
cats 
jd
acm
hed          
di



0  0  0  0  0  0              | endmember flags

                             | NOTE RESTRICTED RANGES:
0. 1.  .1  1                 | range and resolution of X(ccrts): imod = 1 -> assymmetric stretching
0. 1.  .1  1                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching 
0. 1.  .1  0                 | range and resolution of X(jd)
0. 1.  .1  1                 | range and resolution of X(acm): imod = 1 -> assymmetric stretching
0. 1.  .1  0                 | range and resolution of X(hed)


begin_excess_function
w(jd di)     26d3 0. 0.
w(jd hed)    24d3 0. 0.
w(di hed)     4d3 0. 0.
w(cats di)    7d3 0. 0.
w(cats hed)   4d3 0. 0.
end_excess_function

3                             | 3 site (M1, M2, T1) configurational entropy model

5 1.                          | 5 species on M1, 1 site per formula unit.
z(m1,fe) = 1 hed
z(m1,al) = 1 jd + 1 cats
z(m1,fe3+) = 1 acm
z(m1,cr) = 1 ccrts


2 1.                          | 2 species on M2, 1 site per formula unit.
z(m2,na) = 1 jd + 1 acm

2 1.                          | 2 species on T1, ccrts not counted intentionally.
z(t1,al) = 1 cats

end_of_model                  | end of model keyword
                           --------------------------------------------------------
begin_model  

                                      Chromite/Spinel, PGP Workshop 4/12/06.
                                      (folk.uio.no/ninasim/Cr_results.html)
                                                      1       2           
                                                      A       B     
                                                     _____________

                                      Mutliplicity    1       2
                                                     _____________

                                      1 sp            Mg      Al       
                            Species:  2 herc          Fe      Al    
                                      3 mcrm          Mg      Cr         
                                      4 fcrm_d        Fe      Cr    

  
                           Dependent: fcrm_d = herc + mcrm - sp


CrSp                       | solution name.

7                          | model type: Reciprocal 

2                          | 2 independent subcompositions
2 2                        | 2 dimensions on each site

mcrm     fcrm_d  
sp       herc               
                   
1                          | 1 dependent endmember

fcrm_d = 1 herc + 1 mcrm - 1 sp

0 0 0 0                    | endmember flags, indicate if the endmember is part of the solution.

                           | subdivision model for (binary) site 1 (A):
0. 1. .1   0               | range and resolution of X(Mg): imod = 0 -> cartesian 

                           | subdivision model for (binary) site 2 (B)
0. 1.  .1  1               | range and resolution of X(Cr): imod = 1 -> assymmetric stretching 

begin_excess_function                
w(sp herc)      7d2 0 0 
w(mcrm sp sp)   4208. 1.501  .321e-1 | from Oka et al CMP '84
w(mcrm sp)      19686 0.463 0.0183   | 19686 + 0.0183*P + 0.463*T;
w(mcrm herc)    20d3  0. 0.          | guessed solvus
end_excess_function 

2                          | 2 site (a, b) configurational entropy model

2 1.                       | 2 species on a, 1 site per formula unit.

z(a,fe) = 1 herc + 1 fcrm_d
  

2 2.                       | 2 species on b, 2 site per formula unit.
z(b,cr) = 1 fcrm_d + 1 mcrm

end_of_model 
                  --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model 

                               Eskolaite, PGP Workshop 4/12/06.
                               (folk.uio.no/ninasim/Cr_results.html)

Eskol(C)                                                                         
2                                     model type: Margules, endmember fractions.                                                                               

2                                     number of endmembers 
esk cor                               endmember names 

  0  0                        | endmember flags

0. 1.   0.1                   | range X(Cr)
0                             | cartesian model

begin_excess_function
w(esk cor cor)   -5755. .385 -.38e-1       | Chattejee et al '82 Am Min
w(esk cor)       37484  4.334  0.0386      | Chattejee et al '82 Am Min
end_excess_function  

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity 2
z(Al) = 1 cor
end_of_model              
                      --------------------------------------------------------
begin_model                
                           
                             Ca-Amph(D)

                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Na, K, Ti or Mn solution.

                             See Amph(DHP) or bAmph(DHP) for Na-Ca amphibole
 
                                      JADC 5/5/06. 
                        
                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             1 tr            Vac       Mg      Mg     Ca      Si_Si
                             2 ftr           Vac       Fe      Fe     Ca      Si_Si
                             3 ts            Vac       Mg      Al     Ca      Al_Si
                             4 fts           Vac       Fe      Al     Ca      Al_Si
                             5 parg          Na        Mg      Mg_Al  Ca      Al_Si
                             6 fparg         Na        Fe      Fe_Al  Ca      Al_Si
                             9 mfets         Vac       Mg      Fe3+   Ca      Al_Si
                            10 ffets         Vac       Fe      Fe3+   Ca      Al_Si
                             
                             fparg = parg + 4/5 (ftr  - tr)
                             fts   = ts   + 3/5 (ftr  - tr)         


Ca-Amph(D)                 | solution name 
7                          | model type: reciprocal, margules
2                          | 2 site reciprocal solution
2 4                        | 1 binary and 1 quinary                
tr       ftr      
parg     fparg_i  
ts       fts_i  
mfets    ffets_i

3                          | number of dependent endmembers 

fparg_i = 1 parg + 4/5 ftr  - 4/5 tr 
fts_i   = 1 ts   + 3/5 ftr  - 3/5 tr 
ffets_i = 1 mfets + 3/5 ftr  - 3/5 tr 

0 0 0 0 0 0 0 0            | endmember flags.

0. 1.0 0.1                | range and resolution for X(Mg) on site 1
0                         | subdivision scheme : imod = 0 -> cartesian for site 1

0. 1.0 0.1 0              | range and resolution for X(tr) on site 2
0. 1.0 0.1 0              | range and resolution for X(pg) on site 2 
0. 1.  0.1 0              | range and resolution for X(ts) on site 2


begin_excess_function
W(parg tr)  29.3d3 0. 0.
W(parg ts)  18.2d3 0. 0. 
W(parg ftr) 11.4d3 0. 0.  
W(ts tr)    20.8d3 0. 0. 
W(tr ftr)   11.4d3 0. 0.
end_excess_function

4                          | 4 site (A, M1, M2, T1) entropy model 

2 1.                       | 2 species on A (V, Na), 1 site per formula unit.
z(A,Na) = 1 parg  
              
2 2.                       | 2 species on T1, fake site multiplicity of 2.
z(T1,Al) = 1/2 ts + 1/2 fts_i + 1/2 parg + 1/2 mfets 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 tr + 1 ts + 1 parg + 1 mfets

4 2.                       | 4 species on M2, 2 sites pfu
z(m2,mg) = 1 tr + 1/2 parg 
z(m2,fe) = 1 ftr  
z(m2,fe3+) = 1 mfets 

begin_dqf_corrections
dqf(ts) 10000 0 0 
end_dqf_corrections

end_of_model               
                      --------------------------------------------------------
begin_model                
                           
                             Na-Amph(D)

                             Dale et al, CMP 2000 140:353-362 amphibole model
                             without Ca, K, Ti or Mn solution.

                             This model requires a fgl endmember, created as 
                             decribed by Powell's mdep paper.

                             See Amph(DHP) for Na-Ca amphibole
 
                                      JADC 5/5/06. 

                                             A         M1      M2     M4      T1
                                            _________________________________________

                             Mutliplicity    1         3       2      2       2
                                            _________________________________________
  
                             7 gl            Vac       Mg      Al     Na      Si_Si
                             8 fgl           Vac       Fe      Al     Na      Si_Si
                            12 mrieb         Vac       Mg      Fe3+   Na      Si_Si
                            11 rieb          Vac       Fe      Fe3+   Na      Si_Si

                             mrieb_i = 1 rieb + 3/5 tr - 3/5 ftr        

Na-Amph(D)                 | solution name 

7                          | model type: reciprocal, margules

2                          | 2 site reciprocal solution

2 2                        | 2 binaries     
           
gl       fgl  
mrieb_i  rieb

1                          | number of dependent endmembers 

mrieb_i = 1 rieb + 1 gl - 1 fgl

0 0 0 0                    | endmember flags.

0. 1.0 0.1                | range and resolution for X(Mg) on site 1
0                          | subdivision scheme : imod = 0 -> cartesian for site 1

0. 1.0 0.1                | range and resolution for X(Al) on site 2
0                          | subdivision scheme : imod = 0 -> cartesian for site 2

ideal

2                          | 2 site (M1, M2) entropy model 

2 3.                       | 2 species on M1, 3 sites per formula unit
z(m1,mg) = 1 gl 

2 2.                       | 2 species on M2, 2 sites pfu

z(m2,fe3+) = 1 rieb

end_of_model 

begin_model                
                                      magnesio-wuestite solution, stixrude EPSL 07 also xu et al EPSL 08

Wus(stx7)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
per       wus            
  0  0                           | endmember flags
0.0 1.0  0.1 0                   | subdivision range, imod = 0 -> cartesian subdivision
  

begin_excess_function
W(per wus)  13d3 0. 0.            
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity = 1.
z(mg) = 1 per

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      akimotoite (ilmenite-structure) solution, stixrude EPSL 07

Aki(stx7)                                                                                                 
2                                     model type: Margules, macroscopic

3                                    3 endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
                                 | Stixrude pers com (10/07) states 
                                 |     Gex = X(One_Site,Al)*X(One_Site,Mg)*W
                                 | JADC 12/07                                                  

W(aki cor)  66000.  0. 0. 
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                           | perovskite solution, stixrude epsl 07 also xu et al epsl 08
Pv(stx7)                                                                               
2                                     model type: Margules, macroscopic

3                                    3 endmembers
aperov   perov   fperov            
  0  0  0                           | endmember flags

0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision
0. 1.  0.1 0               | subdivision range, imod = 0 -> cartesian subdivision


begin_excess_function
                                 | Stixrude pers com (10/07) 
                                 |     Gex = X(Big_Site,Al)*X(Big_Site,Mg)*W
                                 | JADC 12/07
W(perov aperov)   12000 0. 0.            
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 perov
z(fe) = 1 fperov

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 aperov

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      olivine solution
O(stx7)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 10.6d3 0 0. 0.    | was 5.3 kJ/molar site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model               
                                    Wadleysite solution
Wad(stx7)                                                                               
2                          | model type: Margules, macroscopic

2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) 12.2d3 0. 0.            | 6.1 kJ/site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ringwoodite solution
Ring(stx7)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 7d3  0. 0.          | 3.5 kJ/site
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx7)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 20d3  0. 0.            | was 5 kJ/site
end_excess_function 

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model                             
                      --------------------------------------------------------
begin_model               
                      Spinel after White, RW, Powell, R & Clarke, GL (JMG, 2002)

                      This model has two fake sites, each with a mulitplicity of one.
                      Fe3+ Al and Ti mix on the fake A site, and Mg-Fe2+ mix on the fake B site

                      Replaces Sp(WPH), JADC Mar 5, 2009. 
                                              
                                                      A       B     
                                                     _____________

                                      Mutliplicity    1       1
                                                     _____________

                                      1 sp            Al      Mg        
                            Species:  2 herc          Al      Fe2+    
                                      3 usp           Ti      Fe2+         
                                      4 mt            Fe3+    Fe2+    

Sp(WPC)                      
          
2                                 | model type: Ideal or Margules

4                                 | 4 endmembers 
sp       
herc       
usp      
mt       

0  0  0  0                        | endmember flags
                           

0. 1. .1 0                        | X(sp) subdivision range,   imod = 0 -> cartesian 
0. 0.2  .1  1                     | X(herc) subdivision range, imod = 1 -> assymmetric stretching
0. 0.2  .1  1                     | X(usp) subdivision range,  imod = 1 -> assymmetric stretching
             
begin_excess_function 
W(herc mt)    18.5d3 0  0
W(herc usp)   27d3   0  0
W(sp mt)      40d3   0  0
W(sp usp)     30d3   0  0 
end_excess_function 

2                                     2 site entropy model, see comments above

3 1.                                  3 species, site multiplicity of 1
z(a,Fe3+) =  1 mt
z(a,Ti)   =  1 usp


2 1.                                  2 species, site multiplicity of 1
z(b,Mg)   =  1 sp

end_of_model  

                    --------------------------------------------------------
begin_model        

                    Ilmenite after White, RW, Powell, R, Holland, TJB & Worley, BA (2000)

                                                      A                B     
                                                     _____________________

                                      Mutliplicity    1                1
                                                     _____________________

                                      1 oilm          Fe                Ti       
                            Species:  2 dilm          FeTi              FeTi   
                                      3 hem           Fe3+              Fe3+  
                                      4 pnt           Mn                Ti  
                                      5 geik          Mg                Ti       
                                                           
                                  Model entered by Lucie Tajcamanova, Apr 14, 2008. 

                                  Extended to Mn-Mg, Mar 5, 2009. JADC
                            
                                  Requires the following make definitions 

                                  oilm = ilm -13608. 9.426 0 
                                  dilm = ilm   1993. -2.1 0 


Ilm(WPH)                           
2                          | macroscopic

5                          | 5 endmembers 
pnt 
geik
hem      
oilm      
dilm     
  

0 0 1  0  0                  | endmember flags

0. .2 0.1 1                | subdivision range, X(pnt), imod = 1 -> assymetric
0. .2 0.1 1                | subdivision range, X(geik), imod = 1 -> assymetric
0. 1. 0.1 0                | subdivision range, X(hem), imod = 0 -> cartesian subdivision
0. 1. 0.1 0                | subdivision range, X(oilm), imod = 0 -> cartesian subdivision

begin_excess_function
W(oilm dilm)    15600  0  0 
W(oilm hem)     26600  0  0
W(dilm hem)     11000  0  0 
end_excess_function


2                          | 2 site model
 
4 1.                       | A - Fe2+ Mn Fe3+ Mg
z(A,Mg)   = 1 geik
z(A,mn)   = 1 pnt
z(A,fe3+) = 1 hem

3 1.                       | B - Fe3+ Ti4+ Fe2+
z(b,fe3+) = 1 hem
z(b,fe2+) = 1/2 dilm

end_of_model               
  
                     --------------------------------------------------------
begin_model                | keyword indicating beginning of a solution model

                                      CPX in CMASCH marbles (di-en-cats),
                                      hence enstatite endmember added.

                            Entered by A Proyer, Aug 27, 2008.

                                      based on:
                                      HP '96 Am Min, Non-ideal disordered cpx
                                      Note HP '98 give Wdh = 2500 j/mol.

                                      Configurational entropy model changed
                                      (corrected) from 1 site two 2 site model
                                      and model reformatted. D. Tinkham, 1/04.

                                      Modified for non-ideal cats after 
                                      Zeh et al. (2005) JMG, v. 23, p. 1-17. 
                                      T. Wagner 2/18/06. 
                                      
Cpx(m)

2                                   | model type sf.

3                                   | number of endmembers
en 
cats 
di



0  0  0                      | endmember flags

                             | NOTE RESTRICTED RANGES:


0. 1.  .1  1                 | range and resolution of X(en): imod = 1 -> assymmetric stretching
0. 1.  .1  1                 | range and resolution of X(cats): imod = 1 -> assymmetric stretching 


begin_excess_function
w(en cats)   24d3 0. 0.
w(en di)     24d3 0. 0.
w(cats di)    7d3 0. 0.
end_excess_function

2                             | 2 site (M1, M2) configurational entropy model

2 1.                          | 2 species on M1, 1 site per formula unit.
z(m1,al) = 1 cats


2 1.                          | 2 species on M2, 1 site per formula unit.
z(m2,mg) = 1 en

begin_dqf_corrections
dqf(en) 8100 -4.5 0 
end_dqf_corrections

end_of_model                  | end of model keyword



                      --------------------------------------------------------
begin_model                
                            Olivine in marble; from TC-solution model: Ca only on M2
                            Entered by A Proyer, Aug 27, 2008.
Ol(m)                               
2                          | model type: Ideal or Margules

2                          | 2 endmembers 
fo       mont    
  0  0                     | endmember flags
0. 1. .1 0                 | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function 
w(fo mont) 24000. 0. 0. 
end_excess_function 

1                                     1 site entropy model

2 1.                                  2 species, site multiplicity of 1
z(Ca) = 1 mont

end_of_model               
                      --------------------------------------------------------
begin_model               

Pl(stx8)                   | Xu et al. EPSL 08, to be used with the stx08ver.dat data generated from that paper. 
2                          | model type: Margules or Ideal                                     
2                          | # of endmembers  
ab       an      

  0  0                     | endmember flags

0. 1. .1  0                | imod = 0 -> cartesian subdivision

begin_excess_function 
w(an ab) 26d3 0. 0. 
end_excess_function 

1                          | 1 site molecular model:
2 1.                       
z(Na) = 1 ab

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Spinel solution, fixed order! 
Sp(stx8)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
sp       herc            
  0  0                     | endmember flags
0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(sp herc) 29.6d3  0. 0.            
end_excess_function 

2                                     2 site entropy model

3 8.                                  3 species, site multiplicity = 8.
z(B,mg) = 1/8 sp
z(B,fe) = 1/8 herc

3 4.                                  3 species, site multiplicity = 4.
z(B,mg) = 3/4 sp
z(B,fe) = 3/4 herc

end_of_model                             
                      --------------------------------------------------------
begin_model                
                                      olivine solution
O(stx8)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
fo       fa            
  0  0                     | endmember flags
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(fo fa) 9d3 0 0. 0.   
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 fo

end_of_model               
                      --------------------------------------------------------
begin_model               
                                    Wadleysite solution
Wad(stx8)                                                                               
2                          | model type: Margules, macroscopic

2                          | 2 endmembers
wad       fwad            
  0  0                     | endmember flags
0. 1. .1    0              | subdivision range, imod = 0 -> cartesian subdivision
begin_excess_function
W(wad fwad) -8.6d3 0. 0.     
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 wad

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ringwoodite solution
Ring(stx8)                                                                               
2                                     model type: Margules, macroscopic

2                                     2 endmembers
ring       fring            
  0  0                     | endmember flags

0. 1. .1   0               | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function
W(ring fring) 8d3  0. 0.          
end_excess_function 

1                                     1 site entropy model

2 2.                                  2 species, site multiplicity = 2.
z(mg) = 1 ring

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Opx solution

                                      From Stixrude's endmember notation (parenthesis
                                      used to indicate disordered site populations), it
                                      appears disorder that in the '08 papers the M sites
                                      are now split.

Opx(stx8)                                                                               
2                                     model type: Margules, macroscopic
4                                     4 endmembers
odi  en   fs   ts        
0  0  0  0                            | endmember flags
0. 1. .1  0                         | range and resolution for X(odi)
0. 1. .1  0                         | range and resolution for X(en)
0. 1. .1  0                         | range and resolution for X(fs)

begin_excess_function
W(odi ts) 43.8d3  0. 0.    
W(odi en) 43.8d3  0. 0.      
end_excess_function 

2                                    |2 site entropy model, Al on M2 is associated with Mg on M1 and 
                                     |Ca on M1 is associated with Mg on M2, so reduce M2 site model to
                                     |a two species model?

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Ca) = 1 odi
z(M1,Fe) = 1 fs
3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Al) = 1 ts
z(M2,Fe) = 1 fs


end_of_model                        
                      --------------------------------------------------------
begin_model                

Cpx(stx8)    
                                                                           
2                                     model type: Margules, macroscopic

5                                     # of endmembers
jd  di  hed  mdi cts       
0  0  0  0  0                         endmember flags

0. 1. .1  0                         | range and resolution for X(jd)
0. 1. .1  0                         | range and resolution for X(di)
0. 1. .1  0                         | range and resolution for X(hed)
0. 1. .1  0                         | range and resolution for X(mdi)

begin_excess_function
W(mdi di)    49d3  0. 0.            | Mg-Ca
W(mdi hed)   49d3  0. 0.
W(mdi cts)   49d3  0. 0.
W(jd  di)    486d2 0. 0.            | Na-Ca
W(jd  hed)   486d2 0. 0. 
W(jd  cts)   486d2 0. 0. 
end_excess_function 

2                                     2 site entropy model

3 2.                                  3 species, M1 site multiplicity = 2.
z(M1,Mg) = 1 mdi
z(M1,Na) = 1 jd


3 2.                                  3 species, M2 site multiplicity = 2.
z(M2,Fe) = 1 hed
z(M2,Al) = 1 jd + 1 cts


end_of_model                        
                      --------------------------------------------------------
begin_model                
                                     akimotoite (ilmenite-structure) solution
Aki(stx8)                                                                                                 
2                                    model type: Margules, macroscopic

3                                    3 endmembers
cor   aki   faki           
  1  0  0                           | endmember flags
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0.0 1.  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(aki cor)  42000.  0. 0. 
W(faki cor)  52000.  0. 0. 
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 aki
z(fe) = 1 faki

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 cor

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Garnet solution, from Xu et al '08.                                  

Gt(stx8)                                                                               
2                                     model type: Margules, macroscopic
5                                     # of endmembers
gr   alm  maj  py jmaj          
0  0  0  0  0                         endmember flags
0. 1. .1   0               | range and resolution for X(gr), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(alm), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(maj), imod = 0 -> cartesian subdivision
0. 1. .1   0               | range and resolution for X(py), imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(gr maj)  45000.  0. 0. 
W(gr py)   45000.  0. 0. 
end_excess_function 

2                                     # of sites for configurational entropy model

4 0.                                  4 independent species, A site multiplicity = 0 => variable multiplicity, means need molar amounts of all species 
n(A,ca) = 3 gr
n(A,fe) = 3 alm
n(A,na) = 2 jmaj
n(A,mg) = 3 py + 3 maj

3 2.                                  3 species, B site multiplicity = 2, this is a peculiarity in stixrude's model because he sets r[Al,jmj,B]=2
z(B,Mg) = 1/2 maj 
z(B,Si) = 1/2 maj 

end_of_model       
                      --------------------------------------------------------
begin_model                

Ppv(stx8)                                                                               
2                                     model type: Margules, macroscopic

3                                    3 endmembers
appv  ppv   fppv            
  0  0  0                           | endmember flags

0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision
0. 1.0  0.1  0             | subdivision range, imod = 0 -> cartesian subdivision

begin_excess_function                                                
W(ppv appv)  21000.  0. 0.  
end_excess_function 

2                                     2 site entropy model

3 1.                                  3 species on M site multiplicity = 1.
z(mg) = 1 ppv
z(fe) = 1 fppv

2 1.                                  2 species on T site multiplicity = 1.
z(al) = 1 appv

end_of_model               
                      --------------------------------------------------------
begin_model                
                                      Ca-Ferrite solution.
CF(stx8)                                                                               
2                                     model type: Margules, macroscopic
3                                     3 endmembers
mfer ffer nfer             
0  0  0                           
0. 1. .1   0               
0. 1. .1   0              

ideal

2                                     number of sites for the entropy model

3 1.                                  3 species, A site multiplicity = 1.
z(A,fe) = 1 ffer
z(A,mg) = 1 mfer
                                      
2 1.                                  al-si mixing on only one "T" site.
z(M,Si) = 1 nfer

end_of_model               
                      --------------------------------------------------------
begin_model                
                           Massonne & Willner (EJM, 2008) Ideal Fe2+-Fe3+-Mg pumpellyite 

Pu(M)                                                                                
2                                 | model type: Ideal or Margules
3                                 | 3 endmembers 
pump     fpum     ffpu                 
0  0  0                           | endmember flags
      
0. 1. 0.1  0                      | range and resolution for X(Mg)
0. 1. 0.1  0                      | range and resolution for X(Fe2), 0 -> cartesian

ideal

1                                     1 site entropy model

3 1.                                  3 species, site multiplicity = 1.
z(Fe) = 1 fpum
z(Mg) = 1 pump

end_of_model  
            
